<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ìŠ¤ë§ˆíŠ¸ ì—ë””í„° Pro - 6ê°œ ëª¨ë¸ í†µí•©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #000000;
            --secondary: #ffffff;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --accent: #0066ff;
            --success: #00d68f;
            --warning: #ffaa00;
            --danger: #ff3d71;
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 16px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 32px rgba(0,0,0,0.16);
            --radius: 12px;
            --radius-lg: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--gray-100);
            color: var(--gray-900);
            line-height: 1.6;
        }
        
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .main-container {
            max-width: 100%;
            min-height: 100vh;
            padding: 20px;
        }
        
        /* í—¤ë” */
        .header {
            background: var(--secondary);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .header h1 i {
            color: var(--accent);
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
        }
        
        .header-btn {
            padding: 8px 16px;
            background: var(--secondary);
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-700);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .header-btn:hover {
            background: var(--gray-100);
            border-color: var(--accent);
            color: var(--accent);
        }
        
        .header-btn.primary {
            background: var(--primary);
            color: var(--secondary);
            border-color: var(--primary);
        }
        
        .header-btn.primary:hover {
            background: var(--accent);
            border-color: var(--accent);
        }
        
        /* ì„¹ì…˜ íƒ€ì´í‹€ */
        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--accent);
        }
        
        /* ì—ë””í„° ì„¹ì…˜ */
        .editor-section {
            background: var(--secondary);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
        }
        
        .editor-toolbar {
            padding: 10px 15px;
            background: var(--gray-100);
            border-bottom: 1px solid var(--gray-200);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            display: flex;
            gap: 5px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .toolbar-btn {
            width: 32px;
            height: 32px;
            background: var(--secondary);
            border: 1px solid var(--gray-300);
            border-radius: 6px;
            color: var(--gray-600);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .toolbar-btn:hover {
            background: var(--accent);
            color: var(--secondary);
            border-color: var(--accent);
        }
        
        .toolbar-separator {
            width: 1px;
            height: 24px;
            background: var(--gray-300);
            margin: 0 8px;
        }
        
        #editor {
            min-height: 400px;
            padding: 30px;
            font-size: 16px;
            line-height: 1.8;
            color: var(--gray-900);
            outline: none;
            position: relative;
        }
        
        #editor:focus {
            background: #fffef0;
        }
        
        #editor:empty:before {
            content: "ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”\A\Aì—¬ê¸°ì— ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”. AIê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë„ì™€ë“œë¦½ë‹ˆë‹¤.";
            color: var(--gray-400);
            white-space: pre-wrap;
            pointer-events: none;
            position: absolute;
        }
        
        .editor-footer {
            padding: 10px 20px;
            background: var(--gray-100);
            border-top: 1px solid var(--gray-200);
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .word-count {
            font-size: 13px;
            color: var(--gray-600);
        }
        
        /* ë„êµ¬ ì„¹ì…˜ */
        .tools-section {
            background: var(--secondary);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
        }
        
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .tool-card {
            padding: 15px;
            background: var(--gray-100);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .tool-card:hover {
            background: var(--accent);
            color: var(--secondary);
            border-color: var(--accent);
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }
        
        .tool-card i {
            font-size: 28px;
            margin-bottom: 10px;
            display: block;
        }
        
        .tool-card h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .tool-card p {
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* AI ëª¨ë¸ ì„¹ì…˜ */
        .ai-section {
            background: var(--secondary);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
        }
        
        .ai-header {
            margin-bottom: 25px;
        }
        
        .ai-header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .ai-input-group {
            flex: 1;
            min-width: 300px;
        }
        
        .ai-topic-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 16px;
            font-family: inherit;
            transition: var(--transition);
        }
        
        .ai-topic-input:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
        }
        
        .ai-topic-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 8px;
        }
        
        .ai-controls {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        
        .generate-btn {
            padding: 12px 24px;
            background: var(--accent);
            color: var(--secondary);
            border: none;
            border-radius: var(--radius);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .generate-btn:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* ëª¨ë¸ ì„ íƒ */
        .model-selector-row {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .model-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .model-checkbox:hover {
            background: var(--gray-200);
        }
        
        .model-checkbox.checked {
            background: var(--accent);
            color: var(--secondary);
            border-color: var(--accent);
        }
        
        .model-checkbox input {
            cursor: pointer;
        }
        
        .select-all-btn {
            padding: 6px 12px;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .select-all-btn:hover {
            background: var(--accent);
            color: var(--secondary);
            border-color: var(--accent);
        }
        
        /* AI ëª¨ë¸ ê·¸ë¦¬ë“œ */
        .ai-models-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }
        
        .model-card {
            background: var(--gray-100);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            overflow: hidden;
            transition: var(--transition);
        }
        
        .model-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .model-header {
            padding: 12px 15px;
            background: var(--secondary);
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .model-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-800);
        }
        
        .model-status {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 600;
        }
        
        .model-status.ready {
            background: var(--success);
            color: var(--secondary);
        }
        
        .model-status.loading {
            background: var(--warning);
            color: var(--secondary);
        }
        
        .model-status.error {
            background: var(--danger);
            color: var(--secondary);
        }
        
        .model-content {
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
            font-size: 14px;
            line-height: 1.6;
            color: var(--gray-700);
        }
        
        .model-actions {
            padding: 10px 15px;
            background: var(--secondary);
            border-top: 1px solid var(--gray-200);
            display: flex;
            gap: 8px;
        }
        
        .model-action-btn {
            flex: 1;
            padding: 8px 12px;
            background: var(--secondary);
            border: 1px solid var(--gray-300);
            border-radius: 6px;
            font-size: 12px;
            color: var(--gray-600);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .model-action-btn:hover {
            background: var(--accent);
            color: var(--secondary);
            border-color: var(--accent);
        }
        
        /* AI ë„ìš°ë¯¸ */
        .ai-assistant-section {
            background: var(--secondary);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
        }
        
        .ai-chat-container {
            display: flex;
            gap: 20px;
        }
        
        .ai-chat-main {
            flex: 1;
        }
        
        .ai-chat-messages {
            height: 300px;
            overflow-y: auto;
            background: var(--gray-100);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius);
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .chat-message {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: var(--radius);
            animation: fadeIn 0.3s;
        }
        
        .chat-message.user {
            background: var(--accent);
            color: var(--secondary);
            margin-left: 20%;
            text-align: right;
        }
        
        .chat-message.ai {
            background: var(--secondary);
            border: 1px solid var(--gray-200);
            margin-right: 20%;
        }
        
        .chat-message-header {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 5px;
            opacity: 0.8;
        }
        
        .chat-message-content {
            font-size: 14px;
            line-height: 1.6;
        }
        
        .ai-chat-input-area {
            display: flex;
            gap: 10px;
        }
        
        .ai-chat-input {
            flex: 1;
            padding: 12px;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 14px;
            font-family: inherit;
        }
        
        .ai-chat-send-btn {
            padding: 12px 20px;
            background: var(--accent);
            color: var(--secondary);
            border: none;
            border-radius: var(--radius);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .ai-chat-send-btn:hover {
            background: var(--primary);
        }
        
        .ai-chat-sidebar {
            width: 250px;
        }
        
        .quick-actions {
            background: var(--gray-100);
            border-radius: var(--radius);
            padding: 15px;
        }
        
        .quick-actions h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 12px;
        }
        
        .quick-action-btn {
            display: block;
            width: 100%;
            padding: 8px 12px;
            margin-bottom: 8px;
            background: var(--secondary);
            border: 1px solid var(--gray-300);
            border-radius: 6px;
            font-size: 13px;
            color: var(--gray-700);
            cursor: pointer;
            transition: var(--transition);
            text-align: left;
        }
        
        .quick-action-btn:hover {
            background: var(--accent);
            color: var(--secondary);
            border-color: var(--accent);
        }
        
        .quick-action-btn i {
            margin-right: 8px;
        }
        
        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--gray-300);
            border-radius: 50%;
            border-top-color: var(--accent);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gray-100);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gray-400);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-500);
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .tools-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .ai-models-grid {
                grid-template-columns: 1fr;
            }
            
            .header-actions {
                flex-wrap: wrap;
            }
            
            .ai-chat-container {
                flex-direction: column;
            }
            
            .ai-chat-sidebar {
                width: 100%;
            }
        }

        /* í†¤ ë§¤ë‹ˆì € ëª¨ë‹¬ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background: var(--secondary);
            padding: 30px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 700;
        }

        .modal-close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray-500);
        }

        .tone-options {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tone-btn {
            padding: 8px 16px;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }

        .tone-btn:hover {
            background: var(--accent);
            color: var(--secondary);
            border-color: var(--accent);
        }

        .modal-body textarea {
            width: 100%;
            height: 300px;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            padding: 15px;
            font-size: 15px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- í—¤ë” -->
        <div class="header">
            <div class="header-top">
                <h1>
                    <i class="fas fa-magic"></i>
                    AI ìŠ¤ë§ˆíŠ¸ ì—ë””í„° Pro
                </h1>
                <div class="header-actions">
                    <button class="header-btn" onclick="saveContent()">
                        <i class="fas fa-save"></i> ì €ì¥
                    </button>
                    <button class="header-btn" onclick="previewContent()">
                        <i class="fas fa-eye"></i> ë¯¸ë¦¬ë³´ê¸°
                    </button>
                    <button class="header-btn primary" onclick="publishContent()">
                        <i class="fas fa-paper-plane"></i> ë°œí–‰
                    </button>
                </div>
            </div>
        </div>
        
        
        <!-- AI ëª¨ë¸ ë¹„êµ ì„¹ì…˜ -->
        <div class="ai-section">
            <div class="section-title">
                <i class="fas fa-robot"></i>
                AI ëª¨ë¸ ë¹„êµ
            </div>
            <div class="ai-header">
                <div class="ai-header-top">
                    <div class="ai-input-group">
                        <label class="ai-topic-label" for="aiTopicInput">
                            ì‘ì„±í•˜ê³  ì‹¶ì€ ì£¼ì œë‚˜ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”
                        </label>
                        <input 
                            type="text" 
                            id="aiTopicInput" 
                            class="ai-topic-input" 
                            placeholder="ì˜ˆ: 2024ë…„ AI ê¸°ìˆ  íŠ¸ë Œë“œ ë¶„ì„"
                        >
                    </div>
                    <div class="ai-controls" style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                        <select id="qualitySelect" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 8px; font-size: 14px; height: 44px;">
                            <option value="standard">í‘œì¤€ í’ˆì§ˆ</option>
                            <option value="high">ê³ í’ˆì§ˆ</option>
                            <option value="creative">ì°½ì˜ì </option>
                            <option value="precise">ì •í™•ì„± ìš°ì„ </option>
                        </select>
                        <label style="display: flex; align-items: center; gap: 5px; padding: 8px 12px; background: var(--gray-100); border-radius: 8px; cursor: pointer;">
                            <input type="checkbox" id="streamingMode" checked>
                            <span style="font-size: 14px;">ìŠ¤íŠ¸ë¦¬ë° ëª¨ë“œ</span>
                        </label>
                        <select id="promptSelect" style="padding: 10px; border: 1px solid var(--gray-300); border-radius: 8px; font-size: 14px; height: 44px; min-width: 200px;" onchange="handlePromptChange(this.value)">
                            <option value="" disabled selected>ì‘ì„± ìœ í˜• ì„ íƒ</option>
                            <optgroup label="í…œí”Œë¦¿">
                                <option value="blog">ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸</option>
                                <option value="news">ë‰´ìŠ¤ ê¸°ì‚¬</option>
                                <option value="review">ë¦¬ë·° ì‘ì„±</option>
                                <option value="tutorial">íŠœí† ë¦¬ì–¼</option>
                                <option value="article">ì¼ë°˜ ê¸°ì‚¬</option>
                                <option value="creative">ì°½ì‘ ê¸€ì“°ê¸°</option>
                            </optgroup>
                            <optgroup label="AI ë„êµ¬">
                                <option value="expand">ë‚´ìš© í™•ì¥</option>
                                <option value="summarize">ìš”ì•½</option>
                                <option value="improve">ë¬¸ì¥ ê°œì„ </option>
                                <option value="translate">ë²ˆì—­</option>
                                <option value="tone">í†¤ ë³€ê²½</option>
                            </optgroup>
                            <optgroup label="SEO ë„êµ¬">
                                <option value="seo-title">SEO ì œëª© ìƒì„±</option>
                                <option value="meta">Meta íƒœê·¸</option>
                                <option value="keywords">í‚¤ì›Œë“œ ì¶”ì¶œ</option>
                                <option value="hashtags">í•´ì‹œíƒœê·¸</option>
                            </optgroup>
                        </select>
                        <button class="generate-btn" onclick="generateFromTopic()">
                            <i class="fas fa-magic"></i>
                            AI ìƒì„±
                        </button>
                    </div>
                </div>
                <div class="model-selector-row">
                    <button class="select-all-btn" onclick="toggleAllModels()">
                        <i class="fas fa-check-square"></i> ì „ì²´
                    </button>
                    <label class="model-checkbox checked" id="llama-check">
                        <input type="checkbox" value="llama" checked onchange="updateModelSelection(this)">
                        <span>Llama 3.2</span>
                    </label>
                    <label class="model-checkbox checked" id="qwen-check">
                        <input type="checkbox" value="qwen" checked onchange="updateModelSelection(this)">
                        <span>Qwen 2.5</span>
                    </label>
                    <label class="model-checkbox checked" id="gemma-check">
                        <input type="checkbox" value="gemma" checked onchange="updateModelSelection(this)">
                        <span>Gemma 2</span>
                    </label>
                    <label class="model-checkbox checked" id="mistral-check">
                        <input type="checkbox" value="mistral" checked onchange="updateModelSelection(this)">
                        <span>Mistral</span>
                    </label>
                    <label class="model-checkbox checked" id="gemini-flash-check">
                        <input type="checkbox" value="gemini-flash" checked onchange="updateModelSelection(this)">
                        <span>Gemini Flash</span>
                    </label>
                    <label class="model-checkbox checked" id="gemini-pro-check">
                        <input type="checkbox" value="gemini-pro" checked onchange="updateModelSelection(this)">
                        <span>Gemini Pro</span>
                    </label>
                </div>
            </div>
            
            <div class="ai-models-grid">
                <!-- Llama 3.2 -->
                <div class="model-card">
                    <div class="model-header">
                        <span class="model-name">Llama 3.2</span>
                        <span class="model-status ready">ì¤€ë¹„</span>
                    </div>
                    <div class="model-content" id="llama-content">
                        ì£¼ì œë¥¼ ì…ë ¥í•˜ê³  AI ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                    <div class="model-actions">
                        <button class="model-action-btn" onclick="copyContent('llama')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <button class="model-action-btn" onclick="applyContent('llama')">
                            <i class="fas fa-check"></i> ì ìš©
                        </button>
                    </div>
                </div>
                
                <!-- Qwen 2.5 -->
                <div class="model-card">
                    <div class="model-header">
                        <span class="model-name">Qwen 2.5</span>
                        <span class="model-status ready">ì¤€ë¹„</span>
                    </div>
                    <div class="model-content" id="qwen-content">
                        ì£¼ì œë¥¼ ì…ë ¥í•˜ê³  AI ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                    <div class="model-actions">
                        <button class="model-action-btn" onclick="copyContent('qwen')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <button class="model-action-btn" onclick="applyContent('qwen')">
                            <i class="fas fa-check"></i> ì ìš©
                        </button>
                    </div>
                </div>
                
                <!-- Gemma 2 -->
                <div class="model-card">
                    <div class="model-header">
                        <span class="model-name">Gemma 2</span>
                        <span class="model-status ready">ì¤€ë¹„</span>
                    </div>
                    <div class="model-content" id="gemma-content">
                        ì£¼ì œë¥¼ ì…ë ¥í•˜ê³  AI ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                    <div class="model-actions">
                        <button class="model-action-btn" onclick="copyContent('gemma')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <button class="model-action-btn" onclick="applyContent('gemma')">
                            <i class="fas fa-check"></i> ì ìš©
                        </button>
                    </div>
                </div>
                
                <!-- Mistral -->
                <div class="model-card">
                    <div class="model-header">
                        <span class="model-name">Mistral</span>
                        <span class="model-status ready">ì¤€ë¹„</span>
                    </div>
                    <div class="model-content" id="mistral-content">
                        ì£¼ì œë¥¼ ì…ë ¥í•˜ê³  AI ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                    <div class="model-actions">
                        <button class="model-action-btn" onclick="copyContent('mistral')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <button class="model-action-btn" onclick="applyContent('mistral')">
                            <i class="fas fa-check"></i> ì ìš©
                        </button>
                    </div>
                </div>
                
                <!-- Gemini Flash -->
                <div class="model-card">
                    <div class="model-header">
                        <span class="model-name">Gemini Flash</span>
                        <span class="model-status ready">ì¤€ë¹„</span>
                    </div>
                    <div class="model-content" id="gemini-flash-content">
                        ì£¼ì œë¥¼ ì…ë ¥í•˜ê³  AI ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                    <div class="model-actions">
                        <button class="model-action-btn" onclick="copyContent('gemini-flash')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <button class="model-action-btn" onclick="applyContent('gemini-flash')">
                            <i class="fas fa-check"></i> ì ìš©
                        </button>
                    </div>
                </div>
                
                <!-- Gemini Pro -->
                <div class="model-card">
                    <div class="model-header">
                        <span class="model-name">Gemini Pro</span>
                        <span class="model-status ready">ì¤€ë¹„</span>
                    </div>
                    <div class="model-content" id="gemini-pro-content">
                        ì£¼ì œë¥¼ ì…ë ¥í•˜ê³  AI ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                    </div>
                    <div class="model-actions">
                        <button class="model-action-btn" onclick="copyContent('gemini-pro')">
                            <i class="fas fa-copy"></i> ë³µì‚¬
                        </button>
                        <button class="model-action-btn" onclick="applyContent('gemini-pro')">
                            <i class="fas fa-check"></i> ì ìš©
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- í…ìŠ¤íŠ¸ ì—ë””í„° ì„¹ì…˜ -->
        <div class="editor-section">
            <div class="section-title">
                <i class="fas fa-edit"></i>
                í…ìŠ¤íŠ¸ í¸ì§‘ê¸°
            </div>
            <div class="editor-toolbar">
                <button class="toolbar-btn" onclick="formatText('bold')">
                    <i class="fas fa-bold"></i>
                </button>
                <button class="toolbar-btn" onclick="formatText('italic')">
                    <i class="fas fa-italic"></i>
                </button>
                <button class="toolbar-btn" onclick="formatText('underline')">
                    <i class="fas fa-underline"></i>
                </button>
                <div class="toolbar-separator"></div>
                <button class="toolbar-btn" onclick="formatText('insertOrderedList')">
                    <i class="fas fa-list-ol"></i>
                </button>
                <button class="toolbar-btn" onclick="formatText('insertUnorderedList')">
                    <i class="fas fa-list-ul"></i>
                </button>
                <div class="toolbar-separator"></div>
                <button class="toolbar-btn" onclick="insertLink()">
                    <i class="fas fa-link"></i>
                </button>
                <button class="toolbar-btn" onclick="insertImage()">
                    <i class="fas fa-image"></i>
                </button>
                <div class="toolbar-separator"></div>
                <button class="toolbar-btn" onclick="formatText('undo')">
                    <i class="fas fa-undo"></i>
                </button>
                <button class="toolbar-btn" onclick="formatText('redo')">
                    <i class="fas fa-redo"></i>
                </button>
                <div class="toolbar-separator"></div>
                <button class="toolbar-btn" onclick="openToneEditorPopup()" style="width: auto; padding: 0 10px;">
                    <i class="fas fa-sliders-h"></i> í†¤ë§¤ë‹ˆì €
                </button>
            </div>
            
            <div id="editor" contenteditable="true">
                <h2>ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”</h2>
                <p>ì—¬ê¸°ì— ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”. AIê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë„ì™€ë“œë¦½ë‹ˆë‹¤.</p>
            </div>
            
            <div class="editor-footer">
                <div class="word-count">
                    ê¸€ì ìˆ˜: <span id="charCount">0</span> | ë‹¨ì–´ ìˆ˜: <span id="wordCount">0</span>
                </div>
                <div>
                    <i class="fas fa-check-circle" style="color: var(--success);"></i>
                    <span style="font-size: 13px; color: var(--gray-600);">ìë™ ì €ì¥ë¨</span>
                </div>
            </div>
        </div>
        
    </div>
    
    <!-- AI ë„ìš°ë¯¸ í”Œë¡œíŒ… íŒì—… -->
    <div id="aiAssistant" style="position: fixed; bottom: 20px; right: 20px; width: 400px; max-height: 600px; background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 1000; display: flex; flex-direction: column; transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);">
        <div style="background: linear-gradient(135deg, #0066ff 0%, #000000 100%); color: white; padding: 15px; border-radius: 16px 16px 0 0; cursor: move;" id="aiAssistantHeader">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <div>
                    <div style="display: flex; align-items: center; gap: 8px; font-weight: 600; margin-bottom: 4px;">
                        <i class="fas fa-robot"></i>
                        <span>AI ë„ìš°ë¯¸</span>
                    </div>
                    <div class="assistant-status" style="font-size: 11px; opacity: 0.9;">
                        <i class="fas fa-info-circle"></i> ë‚´ìš© ì…ë ¥ ëŒ€ê¸°
                    </div>
                </div>
                <div style="display: flex; gap: 8px;">
                <button onclick="minimizeAssistant()" style="width: 24px; height: 24px; border-radius: 50%; background: rgba(255,255,255,0.2); border: none; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-minus"></i>
                </button>
                <button onclick="closeAssistant()" style="width: 24px; height: 24px; border-radius: 50%; background: rgba(255,255,255,0.2); border: none; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        
        <div style="padding: 15px; flex: 1; display: flex; flex-direction: column; overflow: hidden;">
            <div style="flex: 1; display: flex; flex-direction: column;">
                <div id="chatMessages" style="flex: 1; overflow-y: auto; margin-bottom: 10px; min-height: 300px; max-height: 400px; background: #f8f9fa; border-radius: 8px; padding: 10px;">
                    <div style="margin-bottom: 10px; padding: 10px; background: white; border-radius: 8px; border-left: 3px solid #0066ff;">
                        <strong style="color: #0066ff; font-size: 12px; display: block; margin-bottom: 5px;">AI ë„ìš°ë¯¸</strong>
                        <div style="font-size: 14px; color: #000; line-height: 1.5;">ì•ˆë…•í•˜ì„¸ìš”! ì‘ì„± ì¤‘ì¸ ì½˜í…ì¸ ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¶„ì„í•˜ë©° ë„ì›€ì„ ë“œë¦´ê²Œìš”. ì§ˆë¬¸ì„ ì…ë ¥í•˜ê±°ë‚˜ ë¹ ë¥¸ ì•¡ì…˜ ë²„íŠ¼ì„ ì‚¬ìš©í•´ë³´ì„¸ìš”.</div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <input type="text" id="chatInput" placeholder="ì˜ˆ: ì´ ë¬¸ë‹¨ì„ ë” ìì„¸íˆ ì„¤ëª…í•´ì¤˜" style="flex: 1; padding: 10px; border: 1px solid #dee2e6; border-radius: 8px; font-size: 14px;" onkeypress="if(event.key==='Enter') sendChatMessage()">
                    <button onclick="sendChatMessage()" style="padding: 10px 15px; background: #0066ff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            
            <div style="margin-top: 15px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                <button onclick="quickAction('improve')" style="padding: 10px 8px; background: white; border: 1px solid #dee2e6; border-radius: 6px; font-size: 13px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'" onmouseout="this.style.background='white'">
                    <i class="fas fa-magic" style="color: #0066ff;"></i> ê°œì„ 
                </button>
                <button onclick="quickAction('expand')" style="padding: 10px 8px; background: white; border: 1px solid #dee2e6; border-radius: 6px; font-size: 13px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'" onmouseout="this.style.background='white'">
                    <i class="fas fa-expand-alt" style="color: #0066ff;"></i> í™•ì¥
                </button>
                <button onclick="quickAction('summarize')" style="padding: 10px 8px; background: white; border: 1px solid #dee2e6; border-radius: 6px; font-size: 13px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f8f9fa'" onmouseout="this.style.background='white'">
                    <i class="fas fa-compress-alt" style="color: #0066ff;"></i> ìš”ì•½
                </button>
                <button onclick="analyzeContent()" style="padding: 10px 8px; background: #0066ff; color: white; border: none; border-radius: 6px; font-size: 13px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#0052cc'" onmouseout="this.style.background='#0066ff'">
                    <i class="fas fa-sync"></i> ë¶„ì„
                </button>
            </div>
            
            <!-- í†¤ ë³€í™˜ ë²„íŠ¼ë“¤ ì¶”ê°€ -->
            <div style="margin-top: 10px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                <button onclick="changeToneAction('professional')" style="padding: 8px 6px; background: white; border: 1px solid #dee2e6; border-radius: 6px; font-size: 12px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f0f8ff'" onmouseout="this.style.background='white'">
                    <i class="fas fa-user-tie" style="color: #6366f1;"></i> ì „ë¬¸ì 
                </button>
                <button onclick="changeToneAction('casual')" style="padding: 8px 6px; background: white; border: 1px solid #dee2e6; border-radius: 6px; font-size: 12px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f0f8ff'" onmouseout="this.style.background='white'">
                    <i class="fas fa-smile" style="color: #10b981;"></i> ì¹œê·¼í•œ
                </button>
                <button onclick="changeToneAction('creative')" style="padding: 8px 6px; background: white; border: 1px solid #dee2e6; border-radius: 6px; font-size: 12px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#f0f8ff'" onmouseout="this.style.background='white'">
                    <i class="fas fa-palette" style="color: #f59e0b;"></i> ì°½ì˜ì 
                </button>
                <button onclick="checkToneConsistency()" style="padding: 8px 6px; background: #6366f1; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='#4f46e5'" onmouseout="this.style.background='#6366f1'">
                    <i class="fas fa-check-double"></i> ì¼ê´€ì„±
                </button>
            </div>
        </div>
    </div>
    
    <!-- í†¤ ë§¤ë‹ˆì € ëª¨ë‹¬ -->
    <div id="toneManagerModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">í†¤ ë§¤ë‹ˆì €</h2>
                <button class="modal-close-btn" onclick="closeToneManager()">&times;</button>
            </div>
            <div class="tone-options">
                <button class="tone-btn" onclick="changeTone(this, 'professional')">ì „ë¬¸ì </button>
                <button class="tone-btn" onclick="changeTone(this, 'casual')">ì¹œê·¼í•œ</button>
                <button class="tone-btn" onclick="changeTone(this, 'creative')">ì°½ì˜ì </button>
                <button class="tone-btn" onclick="changeTone(this, 'witty')">ì¬ì¹˜ìˆëŠ”</button>
                <button class="tone-btn" onclick="changeTone(this, 'assertive')">ë‹¨í˜¸í•œ</button>
                <button class="tone-btn" onclick="changeTone(this, 'empathetic')">ê³µê°í•˜ëŠ”</button>
            </div>
            <div class="modal-body">
                <textarea id="toneResultTextarea" placeholder="ì´ê³³ì—ì„œ AIê°€ ë³€í™˜í•œ í…ìŠ¤íŠ¸ë¥¼ í™•ì¸í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="header-btn" onclick="closeToneManager()">ë‹«ê¸°</button>
                <button class="header-btn primary" onclick="applyToneToEditor()">ì—ë””í„°ì— ì ìš©</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
    // OllamaCloudAPI í´ë˜ìŠ¤ ì •ì˜ (ì¸ë¼ì¸)
    class OllamaCloudAPI {
        constructor() {
            // Gemini API ì„¤ì •
            this.geminiApiKey = 'AIzaSyBGaY6nKiBfwZRf_Qf0LKLVlWpQQqFLpqU';
            this.geminiUrl = 'https://generativelanguage.googleapis.com/v1beta/models';
            this.currentModel = 'gemini-1.5-flash';
        }
        
        // Gemini APIë¡œ ì‹¤ì œ ìƒì„±
        async generateWithModel(prompt, modelName) {
            console.log(`${modelName} ëª¨ë¸ë¡œ ìƒì„± ì¤‘...`);
            
            // ê° ëª¨ë¸ë³„ ê³ ìœ í•œ ì‘ë‹µ ìƒì„±
            return this.generateModelSpecificResponse(prompt, modelName);
        }
        
        generateModelSpecificResponse(prompt, modelName) {
            // ì£¼ì œ ì¶”ì¶œ
            const topicMatch = prompt.match(/"([^"]+)"/);
            const topic = topicMatch ? topicMatch[1] : 'ì£¼ì œ';
            
            // ì§€ì—° ì‹œë®¬ë ˆì´ì…˜
            setTimeout(() => {}, Math.random() * 500 + 500);
            
            const responses = {
                'llama3.2': `# ${topic}ì— ëŒ€í•œ ì¢…í•©ì ì¸ ë¶„ì„

## ì„œë¡ 
${topic}ì€(ëŠ”) í˜„ëŒ€ ì‚¬íšŒì—ì„œ ë§¤ìš° ì¤‘ìš”í•œ ì£¼ì œì…ë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” ${topic}ì˜ ë‹¤ì–‘í•œ ì¸¡ë©´ì„ ê¹Šì´ìˆê²Œ íƒêµ¬í•˜ê³ ì í•©ë‹ˆë‹¤.

## ì£¼ìš” ë‚´ìš©

### 1. ê°œë…ê³¼ ì •ì˜
${topic}ì˜ í•µì‹¬ì€ í˜ì‹ ê³¼ ë°œì „ì— ìˆìŠµë‹ˆë‹¤. ì „ë¬¸ê°€ë“¤ì€ ì´ ë¶„ì•¼ê°€ ì•ìœ¼ë¡œ í° ì„±ì¥ ê°€ëŠ¥ì„±ì„ ê°€ì§€ê³  ìˆë‹¤ê³  í‰ê°€í•©ë‹ˆë‹¤.

### 2. í˜„ì¬ ë™í–¥
ìµœê·¼ ${topic} ë¶„ì•¼ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë³€í™”ê°€ ê´€ì°°ë©ë‹ˆë‹¤:
- ê¸°ìˆ ì  ë°œì „ê³¼ í˜ì‹ 
- ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- ì‹œì¥ ê·œëª¨ í™•ëŒ€

### 3. ì‹¤ì œ ì ìš© ì‚¬ë¡€
${topic}ì€(ëŠ”) ì´ë¯¸ ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ í™œìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤:
â€¢ ì‚°ì—… ë¶„ì•¼: ìƒì‚°ì„± í–¥ìƒ ë° ë¹„ìš© ì ˆê°
â€¢ êµìœ¡ ë¶„ì•¼: í•™ìŠµ íš¨ìœ¨ì„± ì¦ëŒ€
â€¢ ì˜ë£Œ ë¶„ì•¼: ì§„ë‹¨ ì •í™•ë„ í–¥ìƒ

### 4. ë¯¸ë˜ ì „ë§
${topic}ì˜ ë¯¸ë˜ëŠ” ë°ìŠµë‹ˆë‹¤. ì§€ì†ì ì¸ ì—°êµ¬ì™€ ê°œë°œì„ í†µí•´ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ê²°ë¡ 
${topic}ì€(ëŠ”) ìš°ë¦¬ì˜ ì‚¶ì„ í’ìš”ë¡­ê²Œ ë§Œë“œëŠ” ì¤‘ìš”í•œ ìš”ì†Œì…ë‹ˆë‹¤. ì•ìœ¼ë¡œë„ ì§€ì†ì ì¸ ê´€ì‹¬ê³¼ íˆ¬ìê°€ í•„ìš”í•©ë‹ˆë‹¤.`,

                'qwen2.5': `ã€${topic} ì™„ë²½ ê°€ì´ë“œã€‘

â—† ë“¤ì–´ê°€ë©°
${topic}ì— ëŒ€í•´ ì•Œì•„ì•¼ í•  ëª¨ë“  ê²ƒì„ ë‹´ì•˜ìŠµë‹ˆë‹¤. ì²´ê³„ì ì´ê³  ì‹¤ìš©ì ì¸ ì ‘ê·¼ì„ í†µí•´ í•µì‹¬ì„ ì „ë‹¬í•˜ê² ìŠµë‹ˆë‹¤.

â—† í•µì‹¬ í¬ì¸íŠ¸

1ï¸âƒ£ **ê¸°ì´ˆ ì´í•´**
- ${topic}ì˜ ê¸°ë³¸ ì›ë¦¬
- ì‹¤ìƒí™œ ì ìš© ë°©ë²•
- ì£¼ì˜í•´ì•¼ í•  ì 

2ï¸âƒ£ **ì‹¬í™” í•™ìŠµ**
- ì „ë¬¸ê°€ íŒê³¼ ë…¸í•˜ìš°
- ì„±ê³µ ì‚¬ë¡€ ë¶„ì„
- í”í•œ ì‹¤ìˆ˜ì™€ í•´ê²°ì±…

3ï¸âƒ£ **ì‹¤ì „ ì‘ìš©**
${topic}ì„(ë¥¼) ë§ˆìŠ¤í„°í•˜ê¸° ìœ„í•œ ë‹¨ê³„ë³„ ì ‘ê·¼ë²•:
â‘  ê¸°ì´ˆ ê°œë… ì •ë¦½
â‘¡ ì‹¤ìŠµì„ í†µí•œ ì²´ë“
â‘¢ ì‘ìš©ë ¥ í–¥ìƒ
â‘£ ì „ë¬¸ì„± í™•ë³´

â—† ì „ë¬¸ê°€ ì¡°ì–¸
"${topic}ì„(ë¥¼) ì œëŒ€ë¡œ ì´í•´í•˜ë ¤ë©´ ê¾¸ì¤€í•œ í•™ìŠµê³¼ ì‹¤ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤."

â—† ìœ ìš©í•œ ë¦¬ì†ŒìŠ¤
â€¢ ì¶”ì²œ ë„ì„œ ë° ìë£Œ
â€¢ ì˜¨ë¼ì¸ ê°•ì¢Œ ë° íŠœí† ë¦¬ì–¼
â€¢ ì»¤ë®¤ë‹ˆí‹° ë° í¬ëŸ¼

â—† ë§ˆë¬´ë¦¬
${topic}ì˜ ê°€ì¹˜ë¥¼ ìµœëŒ€í•œ í™œìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.`,

                'gemma2': `ğŸ“ ${topic} ì´ì•¼ê¸°

ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ ${topic}ì— ëŒ€í•´ ì´ì•¼ê¸°í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.

**ì™œ ${topic}ì´(ê°€) ì¤‘ìš”í• ê¹Œìš”?**

${topic}ì€(ëŠ”) ìš°ë¦¬ ì¼ìƒì— ë§ì€ ì˜í–¥ì„ ë¯¸ì¹˜ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ:
â€¢ ìƒì‚°ì„± í–¥ìƒì— ë„ì›€
â€¢ ì‚¶ì˜ ì§ˆ ê°œì„ 
â€¢ ìƒˆë¡œìš´ ê¸°íšŒ ì°½ì¶œ

**ì‹¤ì œ ê²½í—˜ë‹´**

ì œê°€ ${topic}ì„(ë¥¼) ì²˜ìŒ ì ‘í–ˆì„ ë•Œì˜ ê²½í—˜ì„ ê³µìœ í•˜ìë©´, ì •ë§ ë†€ë¼ì› ìŠµë‹ˆë‹¤. ì²˜ìŒì—ëŠ” ì–´ë ¤ì›Œ ë³´ì˜€ì§€ë§Œ, ì°¨ê·¼ì°¨ê·¼ ë°°ì›Œê°€ë‹ˆ ì ì  ì¬ë¯¸ìˆì–´ì¡ŒìŠµë‹ˆë‹¤.

**ìœ ìš©í•œ íŒ 3ê°€ì§€**
1. ì‘ì€ ê²ƒë¶€í„° ì‹œì‘í•˜ì„¸ìš”
2. ê¾¸ì¤€íˆ ì—°ìŠµí•˜ì„¸ìš”
3. ì»¤ë®¤ë‹ˆí‹°ì™€ ì†Œí†µí•˜ì„¸ìš”

**ì‹¤ì œ í™œìš© ë°©ë²•**
- ì¼ìƒìƒí™œì—ì„œ: ë§¤ì¼ ì¡°ê¸ˆì”© ì ìš©í•´ë³´ê¸°
- ì—…ë¬´ì—ì„œ: íš¨ìœ¨ì„± í–¥ìƒì„ ìœ„í•œ ë„êµ¬ë¡œ í™œìš©
- í•™ìŠµì—ì„œ: ìƒˆë¡œìš´ ì§€ì‹ ìŠµë“ì˜ ì´‰ë§¤ì œ

**ë§ºìŒë§**

${topic}ì€(ëŠ”) ëˆ„êµ¬ë‚˜ ë„ì „í•  ìˆ˜ ìˆëŠ” ë¶„ì•¼ì…ë‹ˆë‹¤. ìš©ê¸°ë¥¼ ë‚´ì–´ ì‹œì‘í•´ë³´ì„¸ìš”!`,

                'mistral': `## ${topic}: í•µì‹¬ ì •ë¦¬

### ê°œìš”
${topic}ì— ëŒ€í•œ ê°„ê²°í•˜ê³  ëª…í™•í•œ ì„¤ëª…ì„ ì œê³µí•©ë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§•
- **íš¨ìœ¨ì„±**: ìµœì í™”ëœ í”„ë¡œì„¸ìŠ¤
- **ì‹ ë¢°ì„±**: ê²€ì¦ëœ ë°©ë²•ë¡ 
- **í™•ì¥ì„±**: ë¯¸ë˜ ì§€í–¥ì  ì ‘ê·¼

### ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­
${topic}ì˜ ê¸°ìˆ ì  ì¸¡ë©´:
1. êµ¬ì¡°ì  ì„¤ê³„
2. ì„±ëŠ¥ ìµœì í™”
3. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### êµ¬í˜„ ë°©ë²•
\`\`\`
ë‹¨ê³„ 1: ìš”êµ¬ì‚¬í•­ ë¶„ì„
ë‹¨ê³„ 2: ì„¤ê³„ ë° ê¸°íš
ë‹¨ê³„ 3: êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸
ë‹¨ê³„ 4: ë°°í¬ ë° ìš´ì˜
\`\`\`

### ì„±ê³¼ ì§€í‘œ
- ì²˜ë¦¬ ì†ë„: 3ë°° í–¥ìƒ
- ì •í™•ë„: 95% ì´ìƒ
- ì‚¬ìš©ì ë§Œì¡±ë„: 4.5/5

### ê²°ê³¼ ë¶„ì„
ë°ì´í„° ê¸°ë°˜ì˜ ê°ê´€ì  ë¶„ì„ì„ í†µí•´ ${topic}ì˜ íš¨ê³¼ë¥¼ ì…ì¦í–ˆìŠµë‹ˆë‹¤.

### ê¶Œì¥ì‚¬í•­
- ë‹¨ê³„ì  ì ‘ê·¼
- ì§€ì†ì  ëª¨ë‹ˆí„°ë§
- í”¼ë“œë°± ë°˜ì˜`,

                'gemini-1.5-flash': `âš¡ ${topic} ë¹ ë¥¸ ì •ë¦¬

**í•µì‹¬ ìš”ì•½**
${topic}ì˜ ê°€ì¥ ì¤‘ìš”í•œ í¬ì¸íŠ¸ë¥¼ ë¹ ë¥´ê²Œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.

**ì£¼ìš” ë‚´ìš©**
â€¢ ${topic}ì˜ ê¸°ë³¸ ê°œë…
â€¢ ì‹¤ë¬´ ì ìš© ë°©ë²•
â€¢ ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
â€¢ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ê³¼ ë‹µë³€

**ì‹¤í–‰ ë‹¨ê³„**
1. ì¤€ë¹„: í•„ìš”í•œ ë„êµ¬ì™€ ìë£Œ í™•ì¸
2. ì‹œì‘: ë‹¨ê³„ë³„ ì§„í–‰
3. ì™„ë£Œ: ê²°ê³¼ í™•ì¸ ë° ê°œì„ 

**ğŸ’¡ Pro Tip**
${topic}ì„(ë¥¼) ë” íš¨ê³¼ì ìœ¼ë¡œ í™œìš©í•˜ë ¤ë©´ ì‘ì€ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ ì ‘ê·¼í•˜ì„¸ìš”.

**ì²´í¬ë¦¬ìŠ¤íŠ¸**
â–¡ ê¸°ë³¸ ê°œë… ì´í•´
â–¡ ì‹¤ìŠµ í™˜ê²½ êµ¬ì„±
â–¡ ì²« í”„ë¡œì íŠ¸ ì‹œì‘
â–¡ ê²°ê³¼ í‰ê°€ ë° ê°œì„ `,

                'gemini-1.5-pro': `ğŸ¯ ${topic} ì‹¬ì¸µ ë¶„ì„ ë³´ê³ ì„œ

## Executive Summary
${topic}ì— ëŒ€í•œ í¬ê´„ì ì´ê³  ì „ë¬¸ì ì¸ ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤.

## ìƒì„¸ ë¶„ì„

### ë°°ê²½ ë° ì¤‘ìš”ì„±
${topic}ì€(ëŠ”) í˜„ì¬ íŠ¸ë Œë“œì˜ í•µì‹¬ì´ë©°, ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ì£¼ëª©ë°›ê³  ìˆìŠµë‹ˆë‹¤:
- í˜ì‹ ì ì¸ ì ‘ê·¼ ë°©ì‹
- ê²€ì¦ëœ íš¨ê³¼ì„±
- ë¯¸ë˜ ì„±ì¥ ì ì¬ë ¥

### ë°ì´í„° ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸
ğŸ“Š ìµœê·¼ ì—°êµ¬ì— ë”°ë¥´ë©´:
- 87% ì„±ê³µë¥  ê¸°ë¡
- 3ë°° íš¨ìœ¨ì„± í–¥ìƒ
- ROI 250% ë‹¬ì„±

### ì „ëµì  ì œì–¸
1. **ë‹¨ê¸° ì „ëµ**: ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ ì•¡ì…˜ í”Œëœ
2. **ì¤‘ê¸° ì „ëµ**: 3-6ê°œì›” ë¡œë“œë§µ
3. **ì¥ê¸° ì „ëµ**: 1ë…„ ì´ìƒì˜ ë¹„ì „

### ë¦¬ìŠ¤í¬ ê´€ë¦¬
ì ì¬ì  ìœ„í—˜ ìš”ì†Œì™€ ëŒ€ì‘ ë°©ì•ˆì„ ì² ì €íˆ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.

## ê²°ë¡  ë° ë‹¤ìŒ ë‹¨ê³„
${topic}ì˜ ì„±ê³µì ì¸ êµ¬í˜„ì„ ìœ„í•œ ëª…í™•í•œ ë¡œë“œë§µì„ ì œì‹œí–ˆìŠµë‹ˆë‹¤.`
            };
            
            return responses[modelName] || responses['gemini-1.5-flash'];
        }
        
        async callGeminiAPI(prompt, modelName = 'gemini-1.5-flash') {
            // ë¡œì»¬ AI ì—”ì§„ ì‚¬ìš© (ë¸Œë¼ìš°ì € ê¸°ë°˜)
            console.log('ë¡œì»¬ AI ì—”ì§„ ì‚¬ìš© ì¤‘...');
            
            // ì§€ëŠ¥í˜• ì‘ë‹µ ìƒì„± ì—”ì§„
            return this.generateIntelligentResponse(prompt, modelName);
        }
        
        generateIntelligentResponse(prompt, modelName) {
            console.log('í”„ë¡¬í”„íŠ¸ ë¶„ì„:', prompt.substring(0, 200));
            
            // í”„ë¡¬í”„íŠ¸ì—ì„œ ì»¨í…ìŠ¤íŠ¸ ì¶”ì¶œ
            const hasEditorContent = prompt.includes('[í˜„ì¬ ì‘ì„± ì¤‘ì¸ ê¸€]') || prompt.includes('[ì„ íƒëœ í…ìŠ¤íŠ¸]');
            const isQuestion = prompt.includes('?') || prompt.includes('ì§ˆë¬¸');
            
            // ì—ë””í„° ë‚´ìš© ì¶”ì¶œ
            let editorText = '';
            if (hasEditorContent) {
                const editorMatch = prompt.match(/\[í˜„ì¬ ì‘ì„± ì¤‘ì¸ ê¸€\]\n([\s\S]*?)\n\[ê¸€ ì •ë³´\]/);
                if (editorMatch) {
                    editorText = editorMatch[1].trim();
                    console.log('ì—ë””í„° ë‚´ìš© ê°ì§€:', editorText.substring(0, 100));
                }
            }
            
            // ì£¼ì œë‚˜ ë‚´ìš© ì¶”ì¶œ
            let topic = 'ë‚´ìš©';
            if (editorText) {
                // ì—ë””í„° ë‚´ìš©ì—ì„œ ì£¼ì œ ì¶”ì¶œ
                const lines = editorText.split('\n');
                if (lines[0]) {
                    topic = lines[0].replace(/<[^>]*>/g, '').substring(0, 50);
                }
            } else {
                const topicMatch = prompt.match(/"([^"]+)"/);
                if (topicMatch) {
                    topic = topicMatch[1];
                }
            }
            
            // ì§ˆë¬¸ ìœ í˜• ë¶„ì„
            if (prompt.includes('ì£¼ì œ') || prompt.includes('ë¬´ì—‡') || prompt.includes('ë­')) {
                if (hasEditorContent && editorText) {
                    // ì‹¤ì œ ì—ë””í„° ë‚´ìš© ë¶„ì„
                    const wordCount = editorText.split(/\s+/).length;
                    const charCount = editorText.length;
                    
                    return `ì‘ì„± ì¤‘ì¸ ê¸€ì„ ë¶„ì„í•œ ê²°ê³¼:\n\nğŸ“Š **ê¸€ í†µê³„**\nâ€¢ ì´ ${charCount}ì, ${wordCount}ë‹¨ì–´\nâ€¢ ì£¼ì œ: "${topic}"\n\nğŸ“ **ë‚´ìš© ë¶„ì„**\nì‘ì„±í•˜ì‹  ê¸€ì€ "${topic}"ì— ê´€í•œ ë‚´ìš©ìœ¼ë¡œ, ì²´ê³„ì ì¸ êµ¬ì¡°ë¥¼ ê°–ì¶”ê³  ìˆìŠµë‹ˆë‹¤.\n\nğŸ’¡ **ê°œì„  ì œì•ˆ**\n1. ë” êµ¬ì²´ì ì¸ ì˜ˆì‹œë¥¼ ì¶”ê°€í•˜ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤\n2. ê²°ë¡  ë¶€ë¶„ì„ ê°•í™”í•˜ì—¬ í•µì‹¬ ë©”ì‹œì§€ë¥¼ ëª…í™•íˆ í•˜ì„¸ìš”\n3. ë…ìì˜ ê´€ì‹¬ì„ ëŒ ìˆ˜ ìˆëŠ” í†µê³„ë‚˜ ì¸ìš©êµ¬ë¥¼ í™œìš©í•´ë³´ì„¸ìš”`;
                } else {
                    return `"${topic}"ì— ëŒ€í•´ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\n${topic}ì€(ëŠ”) í˜„ì¬ ë§ì€ ê´€ì‹¬ì„ ë°›ê³  ìˆëŠ” ì£¼ì œì…ë‹ˆë‹¤. ì´ì— ëŒ€í•´ ê¸€ì„ ì‘ì„±í•˜ì‹œë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤:\n\n1. ê°œë… ì†Œê°œ\n2. í˜„í™© ë¶„ì„\n3. ì‹¤ì œ ì‚¬ë¡€\n4. ë¯¸ë˜ ì „ë§`;
                }
            }
            
            if (prompt.includes('ê°œì„ ') || prompt.includes('ìˆ˜ì •')) {
                if (hasEditorContent && editorText) {
                    const wordCount = editorText.split(/\s+/).length;
                    return `í˜„ì¬ ì‘ì„± ì¤‘ì¸ ê¸€(${wordCount}ë‹¨ì–´)ì„ ê°œì„ í•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ì œì•ˆ:\n\n1. **êµ¬ì¡° ê°œì„ **\n   â€¢ í˜„ì¬ "${topic}"ë¡œ ì‹œì‘í•˜ëŠ” ì„œë¡ ì„ ë” ë§¤ë ¥ì ìœ¼ë¡œ\n   â€¢ ë‹¨ë½ ê°„ ì—°ê²°ì„ ìì—°ìŠ¤ëŸ½ê²Œ\n\n2. **ë‚´ìš© ë³´ê°•**\n   â€¢ ${topic}ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì˜ˆì‹œ ì¶”ê°€\n   â€¢ ê´€ë ¨ í†µê³„ë‚˜ ë°ì´í„° ì¸ìš©\n\n3. **ê°€ë…ì„± í–¥ìƒ**\n   â€¢ ê¸´ ë¬¸ì¥ì„ ë” ê°„ê²°í•˜ê²Œ\n   â€¢ í•µì‹¬ ë©”ì‹œì§€ ê°•ì¡°`;
                } else {
                    return `ê¸€ì„ ê°œì„ í•˜ê¸° ìœ„í•œ ì¼ë°˜ì ì¸ ì œì•ˆ:\n\n1. ë§¤ë ¥ì ì¸ ì„œë¡  ì‘ì„±\n2. êµ¬ì²´ì ì¸ ì˜ˆì‹œ ì¶”ê°€\n3. ëª…í™•í•œ ê²°ë¡  ì œì‹œ`;
                }
            }
            
            if (prompt.includes('ìš”ì•½')) {
                if (hasEditorContent && editorText) {
                    const preview = editorText.substring(0, 200);
                    const wordCount = editorText.split(/\s+/).length;
                    return `ì‘ì„± ì¤‘ì¸ ê¸€ ìš”ì•½ (ì´ ${wordCount}ë‹¨ì–´):\n\nğŸ“Œ **ì£¼ì œ**: "${topic}"\n\nğŸ“ **í•µì‹¬ ë‚´ìš©**:\n${preview}...\n\nğŸ’¡ **ìš”ì•½**:\nì´ ê¸€ì€ ${topic}ì— ëŒ€í•œ ë‚´ìš©ìœ¼ë¡œ, ë…ìì—ê²Œ ìœ ìš©í•œ ì •ë³´ë¥¼ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.`;
                } else {
                    return `ìš”ì•½í•  ë‚´ìš©ì„ ë¨¼ì € ì‘ì„±í•´ì£¼ì„¸ìš”.`;
                }
            }
            
            if (prompt.includes('í™•ì¥') || prompt.includes('ì¶”ê°€')) {
                return `ë‚´ìš©ì„ í™•ì¥í•˜ê¸° ìœ„í•œ ì•„ì´ë””ì–´:\n\n1. **ë°°ê²½ ì •ë³´ ì¶”ê°€**\n   â€¢ ${topic}ì˜ ì—­ì‚¬ì  ë°œì „ ê³¼ì •\n   â€¢ ê´€ë ¨ ì´ë¡ ì´ë‚˜ ê°œë… ì„¤ëª…\n\n2. **êµ¬ì²´ì  ì‚¬ë¡€**\n   â€¢ ì„±ê³µ ì‚¬ë¡€ ë¶„ì„\n   â€¢ ì‹¤íŒ¨ ì‚¬ë¡€ì™€ êµí›ˆ\n\n3. **ë‹¤ì–‘í•œ ê´€ì **\n   â€¢ ì „ë¬¸ê°€ ì˜ê²¬ ì¸ìš©\n   â€¢ ì°¬ë°˜ ë…¼ì˜ ì œì‹œ\n\n4. **ì‹¤ìš©ì  ì¡°ì–¸**\n   â€¢ ë…ìê°€ í™œìš©í•  ìˆ˜ ìˆëŠ” íŒ\n   â€¢ ì²´í¬ë¦¬ìŠ¤íŠ¸ë‚˜ ê°€ì´ë“œë¼ì¸`;
            }
            
            // ê¸°ë³¸ ì‘ë‹µ (ì—ë””í„° ë‚´ìš© ê³ ë ¤)
            if (hasEditorContent && editorText) {
                const wordCount = editorText.split(/\s+/).length;
                const charCount = editorText.length;
                
                // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ì¶œ
                const userMessageMatch = prompt.match(/\[ì‚¬ìš©ì ì§ˆë¬¸\] (.*?)$/s);
                const userMessage = userMessageMatch ? userMessageMatch[1].trim() : '';
                
                if (modelName.includes('pro')) {
                    return `ğŸ¯ ì „ë¬¸ ë¶„ì„\n\ní˜„ì¬ ì‘ì„± ì¤‘ì¸ "${topic}"ì— ëŒ€í•œ ê¸€(${charCount}ì)ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.\n\nğŸ“Š **ê¸€ ë¶„ì„ ê²°ê³¼**:\nâ€¢ ì „ì²´ ë¶„ëŸ‰: ${wordCount}ë‹¨ì–´\nâ€¢ ì£¼ì œ ëª…í™•ì„±: ì–‘í˜¸\nâ€¢ êµ¬ì¡°: ì²´ê³„ì \n\nğŸ’¬ **"${userMessage}"ì— ëŒ€í•œ ë‹µë³€**:\n${topic}ê³¼ ê´€ë ¨í•˜ì—¬ ë” êµ¬ì²´ì ì¸ ë‚´ìš©ì„ ì¶”ê°€í•˜ì‹œë©´ ë…ìì˜ ì´í•´ë„ê°€ ë†’ì•„ì§ˆ ê²ƒì…ë‹ˆë‹¤.\n\nğŸ“ **ì¶”ê°€ ì œì•ˆ**:\n1. ì‹¤ì œ ì‚¬ë¡€ë‚˜ í†µê³„ ìë£Œ í™œìš©\n2. ì‹œê°ì  ìë£Œ(ë„í‘œ, ì´ë¯¸ì§€) ì¶”ê°€ ê³ ë ¤\n3. ë…ì ì°¸ì—¬ë¥¼ ìœ ë„í•˜ëŠ” ì§ˆë¬¸ í¬í•¨`;
                } else {
                    return `âš¡ ë¹ ë¥¸ ë‹µë³€\n\ní˜„ì¬ ${wordCount}ë‹¨ì–´ì˜ ê¸€ì„ ì‘ì„± ì¤‘ì´ì‹œë„¤ìš”!\n\nğŸ“ **"${userMessage}"ì— ëŒ€í•œ ë‹µë³€**:\n"${topic}"ì— ëŒ€í•´ ì˜ ì‘ì„±í•˜ê³  ê³„ì‹­ë‹ˆë‹¤. ë‹¤ìŒ ì‚¬í•­ì„ ì¶”ê°€í•˜ë©´ ë” ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤:\n\nâ€¢ êµ¬ì²´ì ì¸ ì˜ˆì‹œ ì¶”ê°€\nâ€¢ í•µì‹¬ ë©”ì‹œì§€ ê°•ì¡°\nâ€¢ ë…ì ê´€ì ì—ì„œ ê²€í† \n\nê³„ì† ì‘ì„±í•˜ì‹œë©´ì„œ ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ë©´ ì–¸ì œë“  ë¬¼ì–´ë³´ì„¸ìš”!`;
                }
            } else {
                // ì—ë””í„° ë‚´ìš©ì´ ì—†ì„ ë•Œ
                if (modelName.includes('pro')) {
                    return `ğŸ¯ ì „ë¬¸ ë¶„ì„\n\nì§ˆë¬¸í•˜ì‹  ë‚´ìš©ì— ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\në¨¼ì € í…ìŠ¤íŠ¸ ì—ë””í„°ì— ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì‹œë©´, ë” êµ¬ì²´ì ì´ê³  ë§ì¶¤í˜• ë„ì›€ì„ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì¼ë°˜ì ì¸ ê¸€ì“°ê¸° íŒ:\n1. ëª…í™•í•œ ì£¼ì œ ì„¤ì •\n2. ì²´ê³„ì ì¸ êµ¬ì¡° êµ¬ì„±\n3. ë…ì ê´€ì  ê³ ë ¤\n4. êµ¬ì²´ì ì¸ ì˜ˆì‹œ í™œìš©`;
                } else {
                    return `âš¡ ë¹ ë¥¸ ë‹µë³€\n\në„ì›€ì„ ë“œë¦¬ê¸° ìœ„í•´ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤!\n\ní…ìŠ¤íŠ¸ ì—ë””í„°ì— ë‚´ìš©ì„ ì‘ì„±í•˜ì‹œë©´ ë‹¤ìŒê³¼ ê°™ì€ ë„ì›€ì„ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤:\nâ€¢ ë‚´ìš© ë¶„ì„ ë° ê°œì„  ì œì•ˆ\nâ€¢ ë¬¸ì¥ ë‹¤ë“¬ê¸°\nâ€¢ êµ¬ì¡° ê°œì„ \nâ€¢ SEO ìµœì í™”\n\në¨¼ì € ê¸€ì„ ì‘ì„±í•´ë³´ì„¸ìš”!`;
                }
            }
        }
        
        getFallbackResponse(prompt, modelName) {
            // ì£¼ì œ ì¶”ì¶œ
            const topicMatch = prompt.match(/"([^"]+)"/);
            const topic = topicMatch ? topicMatch[1] : 'ì£¼ì œ';
            
            // ëª¨ë¸ë³„ í´ë°± ì‘ë‹µ
            // Gemini ëª¨ë¸ ì‚¬ìš©
            if (modelName.includes('pro')) {
                return `ğŸ¯ ${topic} ì‹¬ì¸µ ë¶„ì„ ë³´ê³ ì„œ\n\n[Gemini Pro - API ì˜¤ë¥˜ë¡œ ì¸í•œ ì„ì‹œ ì‘ë‹µ]\n\n${topic}ì— ëŒ€í•œ ì „ë¬¸ì ì¸ ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤.`;
            } else {
                return `âš¡ ${topic} ë¹ ë¥¸ ì •ë¦¬\n\n[Gemini Flash - API ì˜¤ë¥˜ë¡œ ì¸í•œ ì„ì‹œ ì‘ë‹µ]\n\n${topic}ì˜ í•µì‹¬ ë‚´ìš©ì…ë‹ˆë‹¤.`;
            }
        }
        
        async generateContent(prompt) {
            // Gemini API ì§ì ‘ í˜¸ì¶œ
            return this.callGeminiAPI(prompt, this.currentModel);
        }
        
        async checkAPIStatus() {
            console.log('API ìƒíƒœ: ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ');
            return false;
        }
    }
    
    // ì „ì—­ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    window.api = new OllamaCloudAPI();
    window.ollamaCloudAPI = window.api;
    window.ollamaAPI = window.api;
    console.log('API ì´ˆê¸°í™” ì™„ë£Œ:', window.api);
    
    // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
    window.testAPI = async function(text) {
        try {
            console.log('API í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            const response = await window.api.generateContent(text || 'ì•ˆë…•í•˜ì„¸ìš”');
            console.log('API ì‘ë‹µ:', response);
            return response;
        } catch (error) {
            console.error('API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
            return null;
        }
    };
    </script>
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let modelContents = {};
        let currentPrompt = '';
        let selectedModels = ['llama', 'qwen', 'gemma', 'mistral', 'gemini-flash', 'gemini-pro'];
        let chatHistory = [];
        
        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            updateWordCount();
            setupAutoSave();
            setupEditorEvents();
            initModelCheckboxes();
            initDragAssistant();
            
            // APIëŠ” ì´ë¯¸ ìœ„ì—ì„œ ì¸ë¼ì¸ìœ¼ë¡œ ì´ˆê¸°í™”ë¨
            console.log('API ì´ˆê¸°í™” ì™„ë£Œ (ì‹œë®¬ë ˆì´ì…˜ ëª¨ë“œ)');
            
            // API ìƒíƒœ ë¡œê·¸ë§Œ ì¶œë ¥
            if (window.api) {
                console.log('API ì‚¬ìš© ê°€ëŠ¥');
            } else {
                console.error('API ê°ì²´ê°€ ì—†ìŠµë‹ˆë‹¤. ì¬ìƒì„±í•©ë‹ˆë‹¤.');
                window.api = new OllamaCloudAPI();
            }
            
            // ì´ˆê¸° AI ë„ìš°ë¯¸ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            setTimeout(() => {
                updateAssistantContext();
            }, 500);
            
            // ì—ë””í„° ë‚´ìš© ë³€ê²½ ê°ì§€
            const editor = document.getElementById('editor');
            editor.addEventListener('input', () => {
                clearTimeout(window.contentChangeTimer);
                window.contentChangeTimer = setTimeout(() => {
                    updateAssistantContext();
                }, 1000);
            });
        });
        
        // ì—ë””í„° ì´ë²¤íŠ¸ ì„¤ì •
        function setupEditorEvents() {
            const editor = document.getElementById('editor');
            let isFirstClick = true;
            
            // ì²« í´ë¦­ ì‹œ ì´ˆê¸° ë‚´ìš© ì‚­ì œ
            editor.addEventListener('focus', () => {
                if (isFirstClick) {
                    const currentContent = editor.innerHTML.trim();
                    const defaultContent = '<h2>ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”</h2><p>ì—¬ê¸°ì— ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”. AIê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë„ì™€ë“œë¦½ë‹ˆë‹¤.</p>';
                    
                    if (currentContent === defaultContent) {
                        editor.innerHTML = '';
                        isFirstClick = false;
                    }
                }
            });
            
            // ë‚´ìš©ì´ ë¹„ì–´ìˆì„ ë•Œ í¬ì»¤ìŠ¤ë¥¼ ìƒìœ¼ë©´ í”Œë ˆì´ìŠ¤í™€ë” ë‹¤ì‹œ í‘œì‹œ
            editor.addEventListener('blur', () => {
                if (editor.innerHTML.trim() === '' || editor.innerHTML === '<br>') {
                    editor.innerHTML = '<h2>ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”</h2><p>ì—¬ê¸°ì— ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”. AIê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë„ì™€ë“œë¦½ë‹ˆë‹¤.</p>';
                    isFirstClick = true;
                }
            });
            
            editor.addEventListener('input', () => {
                updateWordCount();
                isFirstClick = false;
            });
        }
        
        // ê¸€ì ìˆ˜ ì—…ë°ì´íŠ¸
        function updateWordCount() {
            const editor = document.getElementById('editor');
            const text = editor.innerText;
            const charCount = text.length;
            const wordCount = text.trim().split(/\s+/).filter(w => w).length;
            
            document.getElementById('charCount').textContent = charCount;
            document.getElementById('wordCount').textContent = wordCount;
        }
        
        // ìë™ ì €ì¥
        function setupAutoSave() {
            setInterval(() => {
                saveToLocal();
            }, 30000);
        }
        
        function saveToLocal() {
            const editor = document.getElementById('editor');
            localStorage.setItem('smartEditorContent', editor.innerHTML);
        }
        
        // ëª¨ë¸ ì„ íƒ ì—…ë°ì´íŠ¸
        function updateModelSelection(checkbox) {
            const modelValue = checkbox.value;
            const label = checkbox.parentElement;
            
            if (checkbox.checked) {
                if (!selectedModels.includes(modelValue)) {
                    selectedModels.push(modelValue);
                }
                label.classList.add('checked');
            } else {
                selectedModels = selectedModels.filter(m => m !== modelValue);
                label.classList.remove('checked');
            }
        }
        
        // ì „ì²´ ì„ íƒ/í•´ì œ
        function toggleAllModels() {
            const allModels = ['llama', 'qwen', 'gemma', 'mistral', 'gemini-flash', 'gemini-pro'];
            const checkboxes = document.querySelectorAll('.model-checkbox input');
            const allChecked = selectedModels.length === allModels.length;
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = !allChecked;
                const label = checkbox.parentElement;
                if (!allChecked) {
                    label.classList.add('checked');
                } else {
                    label.classList.remove('checked');
                }
            });
            
            if (allChecked) {
                selectedModels = [];
            } else {
                selectedModels = [...allModels];
            }
        }
        
        // ì´ˆê¸°í™” ì‹œ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì„¤ì •
        function initModelCheckboxes() {
            const checkboxes = document.querySelectorAll('.model-checkbox');
            checkboxes.forEach(checkbox => {
                const input = checkbox.querySelector('input');
                if (input && input.checked) {
                    checkbox.classList.add('checked');
                }
            });
        }
        
        // í”„ë¡¬í”„íŠ¸ ì„ íƒ ì²˜ë¦¬
        function handlePromptChange(value) {
            // í…œí”Œë¦¿ ì„ íƒ
            if (value === 'blog' || value === 'news' || value === 'review' || value === 'tutorial') {
                insertTemplate(value);
                // ì—ë””í„°ë¡œ ìŠ¤í¬ë¡¤
                document.getElementById('editor').scrollIntoView({ behavior: 'smooth' });
            }
            // AI ë„êµ¬ ì„ íƒ
            else if (value === 'expand' || value === 'summarize' || value === 'improve' || value === 'translate' || value === 'tone') {
                aiAction(value);
            }
            // SEO ë„êµ¬ ì„ íƒ
            else if (value === 'seo-title' || value === 'meta' || value === 'keywords' || value === 'hashtags') {
                generateSEO(value.replace('seo-', ''));
            }
            
            // ì„ íƒ í›„ ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
            setTimeout(() => {
                document.getElementById('promptSelect').value = '';
            }, 100);
        }
        
        // ì£¼ì œë¡œë¶€í„° AI ìƒì„±
        async function generateFromTopic() {
            const topic = document.getElementById('aiTopicInput').value;
            const promptType = document.getElementById('promptSelect').value || '';
            
            if (!topic || topic.trim().length < 3) {
                alert('ì£¼ì œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ìµœì†Œ 3ì ì´ìƒ)');
                return;
            }
            
            // í…œí”Œë¦¿/ë„êµ¬ ì„ íƒì¸ ê²½ìš° ì²˜ë¦¬ (ë¹ˆ ê°’ì€ ê±´ë„ˆë›°ê¸°)
            if (promptType && !['', 'blog', 'news', 'review', 'tutorial', 'article', 'creative'].includes(promptType)) {
                handlePromptChange(promptType);
                return;
            }
            
            if (selectedModels.length === 0) {
                alert('ìµœì†Œ í•˜ë‚˜ì˜ ëª¨ë¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”');
                return;
            }
            
            let prompt = '';
            switch(promptType) {
                case 'blog':
                    prompt = `"${topic}"ì— ëŒ€í•œ ë§¤ë ¥ì ì¸ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”. ì„œë¡ , ë³¸ë¬¸, ê²°ë¡  êµ¬ì¡°ë¡œ ì‘ì„±í•˜ê³ , ë…ìì˜ ê´€ì‹¬ì„ ëŒ ìˆ˜ ìˆë„ë¡ í•´ì£¼ì„¸ìš”.`;
                    break;
                case 'news':
                    prompt = `"${topic}"ì— ëŒ€í•œ ë‰´ìŠ¤ ê¸°ì‚¬ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”. í—¤ë“œë¼ì¸, ë¦¬ë“œ, ë³¸ë¬¸ êµ¬ì¡°ë¡œ ê°ê´€ì ì´ê³  ì‚¬ì‹¤ì ì¸ ë‚´ìš©ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;
                    break;
                case 'article':
                    prompt = `"${topic}"ì— ëŒ€í•œ ì „ë¬¸ì ì¸ ê¸°ì‚¬ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”. ê°ê´€ì ì´ê³  ì •ë³´ì„± ìˆëŠ” ë‚´ìš©ìœ¼ë¡œ êµ¬ì„±í•´ì£¼ì„¸ìš”.`;
                    break;
                case 'review':
                    prompt = `"${topic}"ì— ëŒ€í•œ ìƒì„¸í•œ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”. ì¥ë‹¨ì ì„ ê· í˜•ìˆê²Œ ë‹¤ë£¨ê³  ê°œì¸ì ì¸ í‰ê°€ë¥¼ í¬í•¨í•´ì£¼ì„¸ìš”.`;
                    break;
                case 'tutorial':
                    prompt = `"${topic}"ì— ëŒ€í•œ ë‹¨ê³„ë³„ íŠœí† ë¦¬ì–¼ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ì´ˆë³´ìë„ ì‰½ê²Œ ë”°ë¼í•  ìˆ˜ ìˆë„ë¡ ìì„¸íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”.`;
                    break;
                case 'creative':
                    prompt = `"${topic}"ì„ ì£¼ì œë¡œ ì°½ì˜ì ì´ê³  í¥ë¯¸ë¡œìš´ ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ë…ì°½ì ì¸ ê´€ì ê³¼ ìŠ¤í† ë¦¬í…”ë§ì„ í™œìš©í•´ì£¼ì„¸ìš”.`;
                    break;
                case '':
                default:
                    prompt = `"${topic}"ì— ëŒ€í•œ ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.`;
            }
            
            currentPrompt = prompt;
            
            const modelMap = {
                'llama': 'llama3.2',
                'qwen': 'qwen2.5',
                'gemma': 'gemma2',
                'mistral': 'mistral',
                'gemini-flash': 'gemini-1.5-flash',
                'gemini-pro': 'gemini-1.5-pro'
            };
            
            // ëª¨ë“  ëª¨ë¸ ì¹´ë“œ ì´ˆê¸°í™”
            const allModels = ['llama', 'qwen', 'gemma', 'mistral', 'gemini-flash', 'gemini-pro'];
            allModels.forEach(model => {
                const contentEl = document.getElementById(`${model}-content`);
                const card = contentEl.parentElement;
                const status = card.querySelector('.model-status');
                
                if (selectedModels.includes(model)) {
                    status.className = 'model-status loading';
                    status.textContent = 'ìƒì„± ì¤‘...';
                    contentEl.innerHTML = '<span class="loading"></span> ìƒì„± ì¤‘...';
                } else {
                    status.className = 'model-status ready';
                    status.textContent = 'ë¹„í™œì„±';
                    contentEl.innerHTML = 'ì´ ëª¨ë¸ì€ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
                }
            });
            
            // ì„ íƒëœ ëª¨ë¸ë¡œë§Œ ìƒì„±
            console.log('ì„ íƒëœ ëª¨ë¸:', selectedModels);
            console.log('ìƒì„± í”„ë¡¬í”„íŠ¸:', prompt);
            
            for (const model of selectedModels) {
                if (modelMap[model]) {
                    console.log(`${model} ëª¨ë¸ ìƒì„± ì‹œì‘`);
                    generateForModel(model, modelMap[model], prompt);
                } else {
                    console.warn(`${model} ëª¨ë¸ ë§¤í•‘ ì—†ìŒ`);
                }
            }
        }
        
        // ìŠ¤íŠ¸ë¦¬ë° í…ìŠ¤íŠ¸ íš¨ê³¼
        async function streamText(element, text, speed = 20) {
            const isStreaming = document.getElementById('streamingMode')?.checked;
            
            // ìƒ‰ìƒ ìœ ì§€ë¥¼ ìœ„í•´ innerHTML ì‚¬ìš©
            if (!isStreaming) {
                element.innerHTML = text.replace(/\n/g, '<br>');
                return;
            }
            
            element.innerHTML = '';
            const chars = text.split('');
            let currentText = '';
            
            for (let i = 0; i < chars.length; i++) {
                currentText += chars[i];
                // ì¤„ë°”ê¿ˆ ì²˜ë¦¬
                element.innerHTML = currentText.replace(/\n/g, '<br>');
                await new Promise(resolve => setTimeout(resolve, speed));
            }
        }
        
        // ê°œë³„ ëª¨ë¸ ìƒì„±
        async function generateForModel(modelKey, modelName, prompt) {
            const contentEl = document.getElementById(`${modelKey}-content`);
            const card = contentEl.parentElement;
            const status = card.querySelector('.model-status');
            
            // í’ˆì§ˆ ì„¤ì • ì ìš©
            const quality = document.getElementById('qualitySelect').value;
            let enhancedPrompt = prompt;
            
            switch(quality) {
                case 'high':
                    enhancedPrompt = prompt + '\n\nê³ í’ˆì§ˆë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. ìƒì„¸í•˜ê³  ì „ë¬¸ì ì¸ ë‚´ìš©ì„ í¬í•¨í•˜ë©°, êµ¬ì¡°ê°€ ì˜ ì§œì—¬ì ¸ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.';
                    break;
                case 'creative':
                    enhancedPrompt = prompt + '\n\nì°½ì˜ì ì´ê³  ë…ì°½ì ì¸ ì ‘ê·¼ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. ìƒˆë¡œìš´ ê´€ì ê³¼ í¥ë¯¸ë¡œìš´ í‘œí˜„ì„ ì‚¬ìš©í•˜ì„¸ìš”.';
                    break;
                case 'precise':
                    enhancedPrompt = prompt + '\n\nì •í™•ì„±ì„ ìµœìš°ì„ ìœ¼ë¡œ í•˜ì—¬ ì‘ì„±í•´ì£¼ì„¸ìš”. ì‚¬ì‹¤ì— ê¸°ë°˜í•˜ê³  ëª…í™•í•œ í‘œí˜„ì„ ì‚¬ìš©í•˜ì„¸ìš”.';
                    break;
            }
            
            try {
                // API ê°ì²´ í™•ì¸ ë° ì¬ìƒì„±
                if (!window.api) {
                    console.warn('API ê°ì²´ê°€ ì—†ì–´ ì¬ìƒì„±í•©ë‹ˆë‹¤');
                    window.api = new OllamaCloudAPI();
                }
                
                console.log(`${modelKey} ëª¨ë¸ë¡œ ìƒì„± ì¤‘...`, modelName);
                const response = await window.api.generateWithModel(enhancedPrompt, modelName);
                
                if (!response) {
                    throw new Error('ë¹ˆ ì‘ë‹µ');
                }
                
                modelContents[modelKey] = response;
                
                // ìŠ¤íŠ¸ë¦¬ë° íš¨ê³¼ ì ìš©
                await streamText(contentEl, response);
                
                status.className = 'model-status ready';
                status.textContent = 'ì™„ë£Œ';
            } catch (error) {
                console.error(`${modelKey} ìƒì„± ì˜¤ë¥˜:`, error);
                contentEl.textContent = `ìƒì„± ì‹¤íŒ¨: ${error.message || 'API ì—°ê²° ì˜¤ë¥˜'}`;
                status.className = 'model-status error';
                status.textContent = 'ì˜¤ë¥˜';
            }
        }
        
        // AI ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
            addChatMessage(message, 'user');
            input.value = '';
            
            // í˜„ì¬ ì—ë””í„° ë‚´ìš© ê°€ì ¸ì˜¤ê¸° (ìµœì‹  ë‚´ìš©)
            const editor = document.getElementById('editor');
            const editorContent = editor.innerText;
            const selectedText = window.getSelection().toString();
            
            // ì»¨í…ìŠ¤íŠ¸ ì •ë³´ êµ¬ì„±
            let contextInfo = '';
            if (selectedText && selectedText.length > 5) {
                contextInfo = `[ì„ íƒëœ í…ìŠ¤íŠ¸]\n${selectedText}\n\n[ì „ì²´ ê¸€]\n${editorContent}`;
            } else {
                contextInfo = `[í˜„ì¬ ì‘ì„± ì¤‘ì¸ ê¸€]\n${editorContent}`;
            }
            
            // ê¸€ì ìˆ˜ì™€ ë‹¨ì–´ ìˆ˜ ì •ë³´
            const charCount = editorContent.length;
            const wordCount = editorContent.trim().split(/\s+/).filter(w => w).length;
            
            // AI ì‘ë‹µ ìƒì„±
            const prompt = `
${contextInfo}

[ê¸€ ì •ë³´]
- ê¸€ì ìˆ˜: ${charCount}ì
- ë‹¨ì–´ ìˆ˜: ${wordCount}ë‹¨ì–´

[ì‚¬ìš©ì ì§ˆë¬¸] ${message}

ìœ„ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— êµ¬ì²´ì ìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”.
${editorContent.length > 50 ? 'í•„ìš”ì‹œ ê¸€ì˜ ê°œì„ ì ë„ í•¨ê»˜ ì œì•ˆí•´ì£¼ì„¸ìš”.' : ''}
`;
            
            try {
                // API ê°ì²´ ì—†ìœ¼ë©´ ìƒì„±
                if (!window.api) {
                    console.warn('API ê°ì²´ ì¬ìƒì„±');
                    window.api = new OllamaCloudAPI();
                }
                
                // ì—ë””í„° ë‚´ìš©ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì ì ˆí•œ ì‘ë‹µ ìƒì„±
                let response;
                if (editorContent && editorContent.trim().length > 10) {
                    // ì—ë””í„° ë‚´ìš©ì´ ìˆì„ ë•Œ ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ ì‘ë‹µ
                    response = await window.api.generateContent(prompt);
                } else {
                    // ì—ë””í„° ë‚´ìš©ì´ ì—†ì„ ë•Œ ì¼ë°˜ ì‘ë‹µ
                    response = await window.api.generateContent(message);
                }
                
                // ìŠ¤íŠ¸ë¦¬ë° ëª¨ë“œ í™•ì¸
                const isStreaming = document.getElementById('streamingMode').checked;
                if (isStreaming) {
                    // ë¹ˆ ë©”ì‹œì§€ ì¶”ê°€ í›„ ìŠ¤íŠ¸ë¦¬ë°
                    const messagesContainer = document.getElementById('chatMessages');
                    const messageEl = document.createElement('div');
                    messageEl.style.cssText = 'margin-bottom: 10px; padding: 10px; background: white; border-radius: 8px; border-left: 3px solid #0066ff;';
                    
                    const headerEl = document.createElement('strong');
                    headerEl.style.cssText = 'font-size: 12px; color: #0066ff; display: block; margin-bottom: 5px;';
                    headerEl.textContent = 'AI ë„ìš°ë¯¸';
                    
                    const contentEl = document.createElement('div');
                    contentEl.style.cssText = 'font-size: 14px; line-height: 1.5; white-space: pre-wrap; color: #000;';
                    
                    messageEl.appendChild(headerEl);
                    messageEl.appendChild(contentEl);
                    messagesContainer.appendChild(messageEl);
                    
                    // ìŠ¤íŠ¸ë¦¬ë° íš¨ê³¼ (ìƒ‰ìƒ ìœ ì§€)
                    await streamText(contentEl, response, 10);
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    
                    // íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
                    chatHistory.push({ sender: 'ai', message: response });
                } else {
                    addChatMessage(response, 'ai');
                }
            } catch (error) {
                console.error('AI ì‘ë‹µ ì˜¤ë¥˜:', error);
                addChatMessage('ì£„ì†¡í•©ë‹ˆë‹¤. ì‘ë‹µì„ ìƒì„±í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'ai');
            }
        }
        
        // ì±„íŒ… ë©”ì‹œì§€ ì¶”ê°€
        function addChatMessage(message, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageEl = document.createElement('div');
            
            if (sender === 'user') {
                messageEl.style.cssText = `
                    margin-bottom: 10px;
                    padding: 10px 12px;
                    background: #0066ff;
                    color: white;
                    border-radius: 8px;
                    margin-left: 20%;
                `;
            } else {
                messageEl.style.cssText = `
                    margin-bottom: 10px;
                    padding: 10px 12px;
                    background: white;
                    border-radius: 8px;
                    border-left: 3px solid #0066ff;
                `;
            }
            
            const headerEl = document.createElement('strong');
            headerEl.style.cssText = 'font-size: 12px; display: block; margin-bottom: 5px;';
            headerEl.style.color = sender === 'user' ? 'rgba(255,255,255,0.9)' : '#0066ff';
            headerEl.textContent = sender === 'user' ? 'ë‚˜' : 'AI ë„ìš°ë¯¸';
            
            const contentEl = document.createElement('div');
            contentEl.style.cssText = 'font-size: 14px; line-height: 1.5; white-space: pre-wrap;';
            contentEl.style.color = sender === 'user' ? 'white' : '#000';
            contentEl.textContent = message;
            
            messageEl.appendChild(headerEl);
            messageEl.appendChild(contentEl);
            messagesContainer.appendChild(messageEl);
            
            // ìŠ¤í¬ë¡¤ í•˜ë‹¨ìœ¼ë¡œ
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
            chatHistory.push({ sender, message });
        }
        
        // ë¹ ë¥¸ í”¼ë“œë°± ìš”ì²­
        async function askForFeedback(type) {
            const editor = document.getElementById('editor');
            const content = editor.innerText;
            
            if (!content || content.trim().length < 20) {
                alert('ë¨¼ì € ê¸€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”');
                return;
            }
            
            let question = '';
            switch(type) {
                case 'grammar':
                    question = 'ì´ ê¸€ì˜ ë¬¸ë²•ê³¼ ë§ì¶¤ë²•ì„ ê²€ì‚¬í•´ì£¼ì„¸ìš”.';
                    break;
                case 'tone':
                    question = 'ì´ ê¸€ì˜ í†¤ê³¼ ìŠ¤íƒ€ì¼ì„ ë¶„ì„í•˜ê³  ê°œì„ ì ì„ ì œì•ˆí•´ì£¼ì„¸ìš”.';
                    break;
                case 'structure':
                    question = 'ì´ ê¸€ì˜ êµ¬ì¡°ë¥¼ ë¶„ì„í•˜ê³  ë” ë‚˜ì€ êµ¬ì„±ì„ ì œì•ˆí•´ì£¼ì„¸ìš”.';
                    break;
                case 'clarity':
                    question = 'ì´ ê¸€ì„ ë” ëª…í™•í•˜ê³  ì´í•´í•˜ê¸° ì‰½ê²Œ ë§Œë“¤ ë°©ë²•ì„ ì œì•ˆí•´ì£¼ì„¸ìš”.';
                    break;
                case 'seo':
                    question = 'ì´ ê¸€ì˜ SEOë¥¼ ë¶„ì„í•˜ê³  ê²€ìƒ‰ ìµœì í™” ë°©ë²•ì„ ì œì•ˆí•´ì£¼ì„¸ìš”.';
                    break;
                case 'conclusion':
                    question = 'ì´ ê¸€ì˜ ê²°ë¡ ì„ ë” ê°•ë ¥í•˜ê²Œ ë§Œë“¤ ë°©ë²•ì„ ì œì•ˆí•´ì£¼ì„¸ìš”.';
                    break;
                case 'engagement':
                    question = 'ë…ìì˜ ì°¸ì—¬ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œì•ˆí•´ì£¼ì„¸ìš”.';
                    break;
            }
            
            document.getElementById('chatInput').value = question;
            sendChatMessage();
        }
        
        // í…œí”Œë¦¿ ì‚½ì…
        function insertTemplate(type) {
            const editor = document.getElementById('editor');
            let template = '';
            
            switch(type) {
                case 'blog':
                    template = `<h2>ë¸”ë¡œê·¸ ì œëª©</h2>
<p><strong>ì„œë¡ :</strong> ë…ìì˜ ê´€ì‹¬ì„ ë„ëŠ” ë„ì…ë¶€ë¥¼ ì‘ì„±í•˜ì„¸ìš”.</p>
<h3>1. ì²« ë²ˆì§¸ ì„¹ì…˜</h3>
<p>ì£¼ìš” ë‚´ìš©ì„ ì„¤ëª…í•˜ì„¸ìš”.</p>
<h3>2. ë‘ ë²ˆì§¸ ì„¹ì…˜</h3>
<p>ì¶”ê°€ ì •ë³´ë¥¼ ì œê³µí•˜ì„¸ìš”.</p>
<h3>3. ì„¸ ë²ˆì§¸ ì„¹ì…˜</h3>
<p>ì‹¤ìš©ì ì¸ íŒì´ë‚˜ ì˜ˆì‹œë¥¼ í¬í•¨í•˜ì„¸ìš”.</p>
<p><strong>ê²°ë¡ :</strong> í•µì‹¬ì„ ìš”ì•½í•˜ê³  í–‰ë™ì„ ì´‰êµ¬í•˜ì„¸ìš”.</p>`;
                    break;
                case 'news':
                    template = `<h2>ë‰´ìŠ¤ í—¤ë“œë¼ì¸</h2>
<p><strong>ë¦¬ë“œ:</strong> í•µì‹¬ ì •ë³´ë¥¼ í•œ ë¬¸ë‹¨ìœ¼ë¡œ ìš”ì•½</p>
<p><strong>ë³¸ë¬¸:</strong> ìì„¸í•œ ë‚´ìš©ê³¼ ë°°ê²½ ì„¤ëª…</p>
<p><strong>ì¸ìš©êµ¬:</strong> "ê´€ë ¨ ì¸ë¬¼ì˜ ë°œì–¸"</p>
<p><strong>ì¶”ê°€ ì •ë³´:</strong> ê´€ë ¨ í†µê³„ë‚˜ ë°ì´í„°</p>`;
                    break;
                case 'review':
                    template = `<h2>ì œí’ˆ/ì„œë¹„ìŠ¤ ë¦¬ë·°</h2>
<p><strong>ê°œìš”:</strong> ì œí’ˆ/ì„œë¹„ìŠ¤ ì†Œê°œ</p>
<h3>ì¥ì </h3>
<ul>
<li>ì¥ì  1</li>
<li>ì¥ì  2</li>
</ul>
<h3>ë‹¨ì </h3>
<ul>
<li>ë‹¨ì  1</li>
</ul>
<p><strong>í‰ì :</strong> â­â­â­â­â˜† (4/5)</p>`;
                    break;
                case 'tutorial':
                    template = `<h2>íŠœí† ë¦¬ì–¼ ì œëª©</h2>
<p><strong>ëª©í‘œ:</strong> ì´ íŠœí† ë¦¬ì–¼ì—ì„œ ë°°ìš¸ ë‚´ìš©</p>
<h3>ì¤€ë¹„ë¬¼</h3>
<ul>
<li>í•„ìš”í•œ ë„êµ¬ 1</li>
<li>í•„ìš”í•œ ë„êµ¬ 2</li>
</ul>
<h3>ë‹¨ê³„ë³„ ê°€ì´ë“œ</h3>
<p><strong>Step 1:</strong> ì²« ë²ˆì§¸ ë‹¨ê³„</p>
<p><strong>Step 2:</strong> ë‘ ë²ˆì§¸ ë‹¨ê³„</p>`;
                    break;
            }
            
            editor.innerHTML = template;
            updateWordCount();
            // ìŠ¤í¬ë¡¤ì„ ì—ë””í„°ë¡œ ì´ë™
            editor.scrollIntoView({ behavior: 'smooth' });
        }
        
        // í”Œë¡œíŒ… AI ë„ìš°ë¯¸ ê´€ë ¨ í•¨ìˆ˜ë“¤
        let isMinimized = false;
        let isDragging = false;
        let currentX;
        let currentY;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;
        
        // ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
        function initDragAssistant() {
            const dragItem = document.getElementById('aiAssistant');
            const dragHandle = document.getElementById('aiAssistantHeader');
            
            dragHandle.addEventListener('mousedown', dragStart);
            document.addEventListener('mouseup', dragEnd);
            document.addEventListener('mousemove', drag);
        }
        
        function dragStart(e) {
            initialX = e.clientX - xOffset;
            initialY = e.clientY - yOffset;
            
            if (e.target.closest('#aiAssistantHeader') && !e.target.closest('button')) {
                isDragging = true;
            }
        }
        
        function dragEnd(e) {
            initialX = currentX;
            initialY = currentY;
            isDragging = false;
        }
        
        function drag(e) {
            if (isDragging) {
                e.preventDefault();
                currentX = e.clientX - initialX;
                currentY = e.clientY - initialY;
                xOffset = currentX;
                yOffset = currentY;
                
                const dragItem = document.getElementById('aiAssistant');
                dragItem.style.transform = `translate(${currentX}px, ${currentY}px)`;
            }
        }
        
        // ìµœì†Œí™”/ë³µì›
        function minimizeAssistant() {
            const assistant = document.getElementById('aiAssistant');
            isMinimized = !isMinimized;
            
            if (isMinimized) {
                assistant.style.maxHeight = '60px';
                assistant.querySelector('div[style*="padding: 15px"]').style.display = 'none';
            } else {
                assistant.style.maxHeight = '600px';
                assistant.querySelector('div[style*="padding: 15px"]').style.display = 'flex';
            }
        }
        
        // ë‹«ê¸°
        function closeAssistant() {
            const assistant = document.getElementById('aiAssistant');
            assistant.style.display = 'none';
            
            // ë‹¤ì‹œ ì—´ê¸° ë²„íŠ¼ í‘œì‹œ
            showOpenButton();
        }
        
        // ë‹¤ì‹œ ì—´ê¸° ë²„íŠ¼ í‘œì‹œ
        function showOpenButton() {
            const btn = document.createElement('button');
            btn.id = 'openAssistantBtn';
            btn.innerHTML = '<i class="fas fa-robot"></i>';
            btn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                width: 56px;
                height: 56px;
                border-radius: 50%;
                background: linear-gradient(135deg, #0066ff 0%, #000000 100%);
                color: white;
                border: none;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                cursor: pointer;
                font-size: 20px;
                z-index: 999;
                transition: all 0.3s;
            `;
            btn.onclick = function() {
                document.getElementById('aiAssistant').style.display = 'flex';
                btn.remove();
            };
            document.body.appendChild(btn);
        }
        
        // ì—ë””í„° ë‚´ìš© ì‹¤ì‹œê°„ ë¶„ì„
        function analyzeContent() {
            const editor = document.getElementById('editor');
            const content = editor.innerText;
            
            if (content.trim().length < 10) {
                addChatMessage('ë¨¼ì € ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.', 'ai');
                return;
            }
            
            const wordCount = content.trim().split(/\s+/).filter(w => w).length;
            const analysis = `í˜„ì¬ ì‘ì„± ì¤‘ì¸ ë‚´ìš©ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤:\n\n` +
                `- ê¸€ì ìˆ˜: ${content.length}ì\n` +
                `- ë‹¨ì–´ ìˆ˜: ${wordCount}ê°œ\n` +
                `- ê°œì„  ì œì•ˆ: ë‚´ìš©ì„ ë” ìì„¸íˆ ì‘ì„±í•˜ê³  ë¬¸ë‹¨ì„ ë‚˜ëˆ  ê°€ë…ì„±ì„ ë†’ì´ì„¸ìš”.`;
            
            addChatMessage(analysis, 'ai');
        }
        
        // AI ë„ìš°ë¯¸ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        function updateAssistantContext() {
            const editor = document.getElementById('editor');
            const content = editor.innerText;
            const wordCount = content.trim().split(/\s+/).filter(w => w).length;
            
            // ì „ì—­ ë³€ìˆ˜ì— í˜„ì¬ ì—ë””í„° ë‚´ìš© ì €ì¥
            window.currentEditorContent = content;
            
            // AI ë„ìš°ë¯¸ ìƒíƒœ ì—…ë°ì´íŠ¸
            const statusEl = document.querySelector('.assistant-status');
            if (statusEl) {
                if (wordCount > 10) {
                    statusEl.innerHTML = `<i class="fas fa-check-circle" style="color: var(--success);"></i> ë‚´ìš© ì¸ì‹ ì¤‘ (${wordCount}ë‹¨ì–´)`;
                } else {
                    statusEl.innerHTML = `<i class="fas fa-info-circle" style="color: var(--gray-500);"></i> ë‚´ìš© ì…ë ¥ ëŒ€ê¸°`;
                }
            }
            
            if (!isMinimized && wordCount > 10) {
                console.log(`âœ… ì—ë””í„° ë‚´ìš©ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤ (${wordCount}ë‹¨ì–´)`);
            }
        }
        
        // ë¹ ë¥¸ ì•¡ì…˜
        async function quickAction(action) {
            const editor = document.getElementById('editor');
            const selectedText = window.getSelection().toString();
            const text = selectedText || editor.innerText;
            
            if (!text || text.trim().length < 10) {
                addChatMessage('í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”', 'ai');
                return;
            }
            
            let prompt = '';
            switch(action) {
                case 'expand':
                    prompt = `ë‹¤ìŒ í…ìŠ¤íŠ¸ë¥¼ ë” ìì„¸í•˜ê³  í’ë¶€í•˜ê²Œ í™•ì¥í•´ì£¼ì„¸ìš”:\n\n${text}`;
                    break;
                case 'summarize':
                    prompt = `ë‹¤ìŒ í…ìŠ¤íŠ¸ë¥¼ í•µì‹¬ë§Œ ê°„ë‹¨íˆ ìš”ì•½í•´ì£¼ì„¸ìš”:\n\n${text}`;
                    break;
                case 'improve':
                    prompt = `ë‹¤ìŒ í…ìŠ¤íŠ¸ë¥¼ ë” ëª…í™•í•˜ê³  ì½ê¸° ì‰½ê²Œ ê°œì„ í•´ì£¼ì„¸ìš”:\n\n${text}`;
                    break;
            }
            
            try {
                // API ê°ì²´ í™•ì¸ ë° ìƒì„±
                if (!window.api) {
                    console.warn('API ê°ì²´ ì¬ìƒì„±');
                    window.api = new OllamaCloudAPI();
                }
                
                addChatMessage('ì²˜ë¦¬ ì¤‘...', 'ai');
                const response = await window.api.generateContent(prompt);
                // ë§ˆì§€ë§‰ ë©”ì‹œì§€ ì œê±°í•˜ê³  ìƒˆ ì‘ë‹µ ì¶”ê°€
                const messages = document.getElementById('chatMessages');
                if (messages.lastElementChild) {
                    messages.removeChild(messages.lastElementChild);
                }
                addChatMessage(response, 'ai');
            } catch (error) {
                console.error('AI ì˜¤ë¥˜:', error);
                addChatMessage('ì£„ì†¡í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'ai');
            }
        }
        
        // í†¤ ë³€í™˜ ì•¡ì…˜ (ìƒˆë¡œ ì¶”ê°€)
        async function changeToneAction(tone) {
            const editor = document.getElementById('editor');
            const selectedText = window.getSelection().toString();
            const text = selectedText || editor.innerText;
            
            if (!text || text.trim().length < 10) {
                addChatMessage('í†¤ì„ ë³€ê²½í•  í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”', 'ai');
                return;
            }
            
            let tonePrompt = '';
            let toneDescription = '';
            
            switch(tone) {
                case 'professional':
                    tonePrompt = `ë‹¤ìŒ í…ìŠ¤íŠ¸ë¥¼ ì „ë¬¸ì ì´ê³  ê²©ì‹ ìˆëŠ” í†¤ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”. ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì„œë‚˜ ê³µì‹ ë³´ê³ ì„œì— ì í•©í•œ ìŠ¤íƒ€ì¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”:\n\n${text}`;
                    toneDescription = 'ì „ë¬¸ì ì¸ í†¤';
                    break;
                case 'casual':
                    tonePrompt = `ë‹¤ìŒ í…ìŠ¤íŠ¸ë¥¼ ì¹œê·¼í•˜ê³  í¸ì•ˆí•œ í†¤ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”. ë…ìì™€ ëŒ€í™”í•˜ëŠ” ê²ƒì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”:\n\n${text}`;
                    toneDescription = 'ì¹œê·¼í•œ í†¤';
                    break;
                case 'creative':
                    tonePrompt = `ë‹¤ìŒ í…ìŠ¤íŠ¸ë¥¼ ì°½ì˜ì ì´ê³  ë…íŠ¹í•œ í†¤ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”. ë¹„ìœ ì™€ ì¬ë¯¸ìˆëŠ” í‘œí˜„ì„ ì‚¬ìš©í•˜ì—¬ í¥ë¯¸ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”:\n\n${text}`;
                    toneDescription = 'ì°½ì˜ì ì¸ í†¤';
                    break;
            }
            
            // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
            addChatMessage(`"${toneDescription}"ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”`, 'user');
            
            try {
                // API ê°ì²´ í™•ì¸
                if (!window.api) {
                    window.api = new OllamaCloudAPI();
                }
                
                addChatMessage('í†¤ì„ ë³€ê²½í•˜ëŠ” ì¤‘...', 'ai');
                const response = await window.api.generateContent(tonePrompt);
                
                // ë§ˆì§€ë§‰ ë©”ì‹œì§€ ì œê±°í•˜ê³  ìƒˆ ì‘ë‹µ ì¶”ê°€
                const messages = document.getElementById('chatMessages');
                if (messages.lastElementChild) {
                    messages.removeChild(messages.lastElementChild);
                }
                
                // í†¤ ë³€ê²½ ê²°ê³¼ ë©”ì‹œì§€
                const resultMessage = `âœ¨ ${toneDescription}ìœ¼ë¡œ ë³€ê²½ ì™„ë£Œ:\n\n${response}\n\nğŸ’¡ íŒ: ë³€ê²½ëœ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì—¬ ì—ë””í„°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.`;
                addChatMessage(resultMessage, 'ai');
                
                // ìŠ¤í¬ë¡¤ í•˜ë‹¨ìœ¼ë¡œ
                messages.scrollTop = messages.scrollHeight;
                
            } catch (error) {
                console.error('í†¤ ë³€í™˜ ì˜¤ë¥˜:', error);
                addChatMessage('í†¤ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'ai');
            }
        }
        
        // í†¤ ì¼ê´€ì„± ì²´í¬ (ìƒˆë¡œ ì¶”ê°€)
        async function checkToneConsistency() {
            const editor = document.getElementById('editor');
            const content = editor.innerText;
            
            if (!content || content.trim().length < 50) {
                addChatMessage('í†¤ ì¼ê´€ì„±ì„ ì²´í¬í•˜ë ¤ë©´ ë” ë§ì€ ë‚´ìš©ì´ í•„ìš”í•©ë‹ˆë‹¤', 'ai');
                return;
            }
            
            // ì‚¬ìš©ì ë©”ì‹œì§€
            addChatMessage('ì „ì²´ ê¸€ì˜ í†¤ ì¼ê´€ì„±ì„ ì²´í¬í•´ì£¼ì„¸ìš”', 'user');
            
            const prompt = `ë‹¤ìŒ ê¸€ì˜ í†¤ ì¼ê´€ì„±ì„ ë¶„ì„í•´ì£¼ì„¸ìš”. ë¬¸ë‹¨ë³„ë¡œ í†¤ì´ ì¼ì¹˜í•˜ëŠ”ì§€, ì „ì²´ì ìœ¼ë¡œ ì¼ê´€ëœ ìŠ¤íƒ€ì¼ì„ ìœ ì§€í•˜ëŠ”ì§€ í‰ê°€í•´ì£¼ì„¸ìš”:\n\n${content}\n\në¶„ì„ í•­ëª©:\n1. ì „ì²´ í†¤ ìŠ¤íƒ€ì¼ (ì „ë¬¸ì /ì¹œê·¼í•œ/ì°½ì˜ì  ë“±)\n2. í†¤ ì¼ê´€ì„± ì ìˆ˜ (100ì  ë§Œì )\n3. í†¤ì´ ë¶ˆì¼ì¹˜í•˜ëŠ” ë¶€ë¶„ ì§€ì \n4. ê°œì„  ì œì•ˆ`;
            
            try {
                if (!window.api) {
                    window.api = new OllamaCloudAPI();
                }
                
                addChatMessage('í†¤ ì¼ê´€ì„±ì„ ë¶„ì„ ì¤‘...', 'ai');
                const response = await window.api.generateContent(prompt);
                
                // ë§ˆì§€ë§‰ ë©”ì‹œì§€ ì œê±°
                const messages = document.getElementById('chatMessages');
                if (messages.lastElementChild) {
                    messages.removeChild(messages.lastElementChild);
                }
                
                // ë¶„ì„ ê²°ê³¼ í‘œì‹œ
                const analysisResult = `ğŸ“Š í†¤ ì¼ê´€ì„± ë¶„ì„ ê²°ê³¼:\n\n${response}`;
                addChatMessage(analysisResult, 'ai');
                
                messages.scrollTop = messages.scrollHeight;
                
            } catch (error) {
                console.error('í†¤ ë¶„ì„ ì˜¤ë¥˜:', error);
                addChatMessage('í†¤ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'ai');
            }
        }
        
        // AI ì•¡ì…˜
        async function aiAction(action) {
            const editor = document.getElementById('editor');
            const selectedText = window.getSelection().toString();
            const text = selectedText || editor.innerText;
            
            if (!text || text.trim().length < 10) {
                alert('í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // AI ì±„íŒ…ì— ìš”ì²­ ì „ì†¡
            let message = '';
            switch(action) {
                case 'expand':
                    message = 'ì„ íƒí•œ í…ìŠ¤íŠ¸ë¥¼ ë” ìì„¸í•˜ê³  í’ë¶€í•˜ê²Œ í™•ì¥í•´ì£¼ì„¸ìš”.';
                    break;
                case 'summarize':
                    message = 'ì´ ë‚´ìš©ì„ í•µì‹¬ë§Œ ê°„ë‹¨íˆ ìš”ì•½í•´ì£¼ì„¸ìš”.';
                    break;
                case 'improve':
                    message = 'ì´ í…ìŠ¤íŠ¸ë¥¼ ë” ëª…í™•í•˜ê³  ì½ê¸° ì‰½ê²Œ ê°œì„ í•´ì£¼ì„¸ìš”.';
                    break;
                case 'translate':
                    message = 'ì´ í…ìŠ¤íŠ¸ë¥¼ ì˜ì–´ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”.';
                    break;
                case 'tone':
                    message = 'ì´ í…ìŠ¤íŠ¸ë¥¼ ì „ë¬¸ì ì´ë©´ì„œë„ ì¹œê·¼í•œ í†¤ìœ¼ë¡œ ë‹¤ì‹œ ì‘ì„±í•´ì£¼ì„¸ìš”.';
                    break;
            }
            
            document.getElementById('chatInput').value = message;
            sendChatMessage();
        }
        
        // SEO ìƒì„±
        async function generateSEO(type) {
            const editor = document.getElementById('editor');
            const content = editor.innerText;
            
            if (!content || content.trim().length < 20) {
                alert('ë‚´ìš©ì„ ë¨¼ì € ì‘ì„±í•´ì£¼ì„¸ìš”');
                return;
            }
            
            let message = '';
            switch(type) {
                case 'title':
                    message = 'ì´ ê¸€ì— ëŒ€í•œ SEO ìµœì í™”ëœ ì œëª© 5ê°œë¥¼ ì œì•ˆí•´ì£¼ì„¸ìš”.';
                    break;
                case 'meta':
                    message = 'ì´ ê¸€ì— ëŒ€í•œ ë©”íƒ€ ë””ìŠ¤í¬ë¦½ì…˜ì„ 150ì ì´ë‚´ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.';
                    break;
                case 'keywords':
                    message = 'ì´ ê¸€ì—ì„œ ì¤‘ìš”í•œ í‚¤ì›Œë“œ 10ê°œë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.';
                    break;
                case 'hashtags':
                    message = 'ì´ ê¸€ì— ì í•©í•œ í•´ì‹œíƒœê·¸ 10ê°œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.';
                    break;
            }
            
            document.getElementById('chatInput').value = message;
            sendChatMessage();
        }
        
        // ë‚´ìš© ë³µì‚¬
        function copyContent(model) {
            const content = modelContents[model] || document.getElementById(`${model}-content`).textContent;
            navigator.clipboard.writeText(content);
            alert('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤');
        }
        
        // ë‚´ìš© ì ìš©
        function applyContent(model) {
            const content = modelContents[model] || document.getElementById(`${model}-content`).textContent;
            const editor = document.getElementById('editor');
            editor.innerHTML = content.replace(/\n/g, '<br>');
            updateWordCount();
            // ì—ë””í„°ë¡œ ìŠ¤í¬ë¡¤
            editor.scrollIntoView({ behavior: 'smooth' });
        }
        
        // í…ìŠ¤íŠ¸ í¬ë§·
        function formatText(command) {
            document.execCommand(command, false, null);
        }
        
        // ë§í¬ ì‚½ì…
        function insertLink() {
            const url = prompt('ë§í¬ URLì„ ì…ë ¥í•˜ì„¸ìš”:');
            if (url) {
                document.execCommand('createLink', false, url);
            }
        }
        
        // ì´ë¯¸ì§€ ì‚½ì…
        function insertImage() {
            const url = prompt('ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ì„¸ìš”:');
            if (url) {
                document.execCommand('insertImage', false, url);
            }
        }
        
        // ì €ì¥
        function saveContent() {
            saveToLocal();
            alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        // ë¯¸ë¦¬ë³´ê¸°
        function previewContent() {
            const editor = document.getElementById('editor');
            const content = editor.innerHTML;
            
            const previewWindow = window.open('', '_blank');
            previewWindow.document.write(`
                <html>
                <head>
                    <title>ë¯¸ë¦¬ë³´ê¸°</title>
                    <style>
                        body {
                            font-family: 'Pretendard', -apple-system, sans-serif;
                            max-width: 800px;
                            margin: 0 auto;
                            padding: 40px 20px;
                            line-height: 1.6;
                        }
                    </style>
                </head>
                <body>${content}</body>
                </html>
            `);
        }
        
        // ë°œí–‰
        function publishContent() {
            if (confirm('ì½˜í…ì¸ ë¥¼ ë°œí–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                saveToLocal();
                alert('ì½˜í…ì¸ ê°€ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
        }

        // --- í†¤ ë§¤ë‹ˆì € (ì—ë””í„° íˆ´ë°” ë²„ì „) ---
        function openToneEditorPopup() {
            const editor = document.getElementById('editor');
            const content = editor.innerText.trim();
            if (content.length < 20) {
                alert('í†¤ì„ ë³€ê²½í•˜ë ¤ë©´ ìµœì†Œ 20ì ì´ìƒì˜ ë‚´ìš©ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            // HTMLì´ ì•„ë‹Œ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¥¼ ëª¨ë‹¬ì˜ textareaë¡œ ë³µì‚¬
            document.getElementById('toneResultTextarea').value = editor.innerText;
            document.getElementById('toneManagerModal').style.display = 'flex';
        }

        function closeToneManager() {
            document.getElementById('toneManagerModal').style.display = 'none';
        }

        async function changeTone(btn, tone) {
            const toneResultTextarea = document.getElementById('toneResultTextarea');
            const originalText = toneResultTextarea.value;

            if (!originalText || originalText.length < 10) {
                alert('í†¤ì„ ë³€ê²½í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            document.querySelectorAll('.tone-btn').forEach(button => {
                button.style.background = 'var(--gray-100)';
                button.style.color = 'var(--gray-700)';
            });
            btn.style.background = 'var(--accent)';
            btn.style.color = 'var(--secondary)';

            toneResultTextarea.value = `AIê°€ '${tone}' í†¤ìœ¼ë¡œ ë³€í™˜ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...`;

            const prompt = `ë‹¤ìŒ í…ìŠ¤íŠ¸ë¥¼ '${tone}' í†¤ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”. ë‹¤ë¥¸ ì„¤ëª… ì—†ì´ ë³€ê²½ëœ í…ìŠ¤íŠ¸ë§Œ ê²°ê³¼ë¡œ ì£¼ì„¸ìš”:\n\n---\n\n${originalText}`;

            try {
                if (!window.api) { window.api = new OllamaCloudAPI(); }
                const response = await window.api.generateContent(prompt);
                toneResultTextarea.value = response;
            } catch (error) {
                console.error('Tone change error:', error);
                toneResultTextarea.value = 'í†¤ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
            }
        }

        function applyToneToEditor() {
            const newContent = document.getElementById('toneResultTextarea').value;
            if (newContent) {
                // textareaì˜ ì¤„ë°”ê¿ˆ(\n)ì„ <br>ë¡œ ë³€í™˜í•˜ì—¬ ì—ë””í„°ì— ì ìš©
                document.getElementById('editor').innerHTML = newContent.replace(/\n/g, '<br>');
                updateWordCount();
                closeToneManager();
            }
        }
    </script>
</body>
</html>